<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL | Urnot</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="web前端技术博客,专注web前端学习与总结。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.52c5fec9.css" as="style"><link rel="preload" href="/assets/js/app.50cd9723.js" as="script"><link rel="preload" href="/assets/js/2.9b737b66.js" as="script"><link rel="preload" href="/assets/js/9.57a4b005.js" as="script"><link rel="prefetch" href="/assets/js/10.b212cb5b.js"><link rel="prefetch" href="/assets/js/11.bd7a2f50.js"><link rel="prefetch" href="/assets/js/12.fdde1415.js"><link rel="prefetch" href="/assets/js/13.0f9721cf.js"><link rel="prefetch" href="/assets/js/14.65f2e0c2.js"><link rel="prefetch" href="/assets/js/15.68a0885a.js"><link rel="prefetch" href="/assets/js/16.b212a5f6.js"><link rel="prefetch" href="/assets/js/17.0753f765.js"><link rel="prefetch" href="/assets/js/18.783041c3.js"><link rel="prefetch" href="/assets/js/19.1492e5bf.js"><link rel="prefetch" href="/assets/js/20.7831d245.js"><link rel="prefetch" href="/assets/js/3.11c9e138.js"><link rel="prefetch" href="/assets/js/4.654a78a2.js"><link rel="prefetch" href="/assets/js/5.849eb2c8.js"><link rel="prefetch" href="/assets/js/6.e0c04a27.js"><link rel="prefetch" href="/assets/js/7.89a2eb6d.js"><link rel="prefetch" href="/assets/js/8.27e4aac5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.52c5fec9.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Urnot" class="logo"> <span class="site-name can-hide">Urnot</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue2.html" class="nav-link">vue2</a></li><li class="dropdown-subitem"><a href="/vue3.html" class="nav-link">vue3</a></li><li class="dropdown-subitem"><a href="/Ajax.html" class="nav-link">Ajax</a></li><li class="dropdown-subitem"><a href="/微信小程序.html" class="nav-link">微信小程序</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/express.html" class="nav-link">express</a></li><li class="dropdown-subitem"><a href="/koa.html" class="nav-link">koa</a></li><li class="dropdown-subitem"><a href="/MySQL.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">MySQL</a></li><li class="dropdown-subitem"><a href="/Sequelize.html" class="nav-link">Sequelize</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><!----> <span class="title" style="display:;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://cn.vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://panjiachen.github.io/vue-element-admin-site/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-admin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://es6.ruanyifeng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ES6
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://developer.mozilla.org/zh-CN/docs/Web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  web技术
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.expressjs.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Express
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://koa.bootcss.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.zcool.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  站酷
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://dribbble.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  dribbble
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.iconfont.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  icon
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://uirush.com/design#%E7%83%AD%E9%97%A8" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百宝箱
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>Urnot</h3> <span>个人博客</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue2.html" class="nav-link">vue2</a></li><li class="dropdown-subitem"><a href="/vue3.html" class="nav-link">vue3</a></li><li class="dropdown-subitem"><a href="/Ajax.html" class="nav-link">Ajax</a></li><li class="dropdown-subitem"><a href="/微信小程序.html" class="nav-link">微信小程序</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/express.html" class="nav-link">express</a></li><li class="dropdown-subitem"><a href="/koa.html" class="nav-link">koa</a></li><li class="dropdown-subitem"><a href="/MySQL.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">MySQL</a></li><li class="dropdown-subitem"><a href="/Sequelize.html" class="nav-link">Sequelize</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><!----> <span class="title" style="display:;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://cn.vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://panjiachen.github.io/vue-element-admin-site/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-admin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://es6.ruanyifeng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ES6
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://developer.mozilla.org/zh-CN/docs/Web" target="_blank" rel="noopener noreferrer" class="nav-link external">
  web技术
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.expressjs.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Express
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://koa.bootcss.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  koa
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>设计</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.zcool.com.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  站酷
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://dribbble.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  dribbble
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.iconfont.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  icon
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://uirush.com/design#%E7%83%AD%E9%97%A8" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百宝箱
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div> <!----></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><!----> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>Urnot</a></div> <!----> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">MySQL<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="mysql"><a href="#mysql" class="header-anchor">#</a> MySQL</h1> <h2 id="_1-数据库的连接和断开"><a href="#_1-数据库的连接和断开" class="header-anchor">#</a> 1.数据库的连接和断开</h2> <h3 id="_1-1-链接mysql服务器"><a href="#_1-1-链接mysql服务器" class="header-anchor">#</a> 1.1 链接mysql服务器</h3> <p><code>mysql -h127.0.0.1 -P3306 -uroot -proot</code></p> <p>-h 主机地址</p> <p>-P 端口号</p> <p>-u 用户名</p> <p>-p 用户密码</p> <p>注意点:</p> <p>① 如果MySQL服务器在本地, 主机地址可以省略</p> <p>② 如果服务器使用默认3306端口, 端口号可以省略</p> <p>mysql -h127.0.0.1 -P3306 -uroot -proot   链接远程MySQL服务器</p> <p>mysql -h127.0.0.1  -uroot -proot  链接远程MySQL服务器, 使用默认端口3306</p> <p>mysql -uroot -proot 链接本地的MySQL服务器, 使用默认端口3306</p> <p>mysql -uroot -p  密码采用暗文形式</p> <p>最常用的方式:</p> <p>mysql -h127.0.0.1  -uroot -p  链接远程MySQL服务器, 使用默认端口3306</p> <h3 id="_1-2-退出链接"><a href="#_1-2-退出链接" class="header-anchor">#</a> 1.2 退出链接</h3> <p>exit;</p> <p>quit</p> <p>\q</p> <h3 id="_1-3-显示数据库"><a href="#_1-3-显示数据库" class="header-anchor">#</a> 1.3 显示数据库</h3> <p>show databases;</p> <p>注意: 后面有s</p> <h4 id="_1-3-1-information-schema"><a href="#_1-3-1-information-schema" class="header-anchor">#</a> 1.3.1 information_schema</h4> <p>保存着关于MySQL服务器所维护的所有其他数据库的信息。</p> <p>如数据库名，数据库的表，表栏的数据类型与访问权限等</p> <h4 id="_1-3-2-mysql"><a href="#_1-3-2-mysql" class="header-anchor">#</a> 1.3.2 mysql</h4> <p>MySQL系统数据库, 保存了登录用户名,密码,以及每个用户的权限等等</p> <h4 id="_1-3-3-performance-schema"><a href="#_1-3-3-performance-schema" class="header-anchor">#</a> 1.3.3 performance_schema</h4> <p>用来保存数据库服务器性能的参数</p> <h4 id="_1-3-4-sys"><a href="#_1-3-4-sys" class="header-anchor">#</a> 1.3.4 sys</h4> <p>这个库是通过视图的形式把information_schema和performance_schema结合起来，查询出更加令人容易理解的数据</p> <h2 id="_2-数据库sql简介"><a href="#_2-数据库sql简介" class="header-anchor">#</a> 2.数据库SQL简介</h2> <h3 id="_2-1-如何使用mysql"><a href="#_2-1-如何使用mysql" class="header-anchor">#</a> 2.1 如何使用MySQL</h3> <p>1.0学习MySQL和学习Excel差不多</p> <p>使用Excel步骤: 安装Excel-创建Excel文件-创建表-在表中存储数据</p> <p>使用MySQL步骤: 安装MySQL-创建数据库----创建表-在表中存储数据</p> <p>1.1学习MySQL本质上就是学习数据库的增删改查(CRUD)</p> <p>1.2在MySQL中主要有三种类型的增删改查, 分别是:</p> <p>1.2.1数据库的增删改查</p> <p>1.2.2表的增删改查</p> <p>1.2.3数据的增删改查</p> <p>MySQL中可以有0~N个数据库, 数据库中可以有0~N个表, 表中可以有0~N个数据</p> <h3 id="_2-2-什么是sql"><a href="#_2-2-什么是sql" class="header-anchor">#</a> 2.2 什么是SQL？</h3> <p>结构化查询语言(Structured Query Language)简称</p> <p>是用来操作关系型数据库的一门语言</p> <p>是一个关系型数据库通用的操作语言</p> <p>注意点:</p> <p>各大厂商为了更多的占用市场份额, 都会在标准的SQL基础上扩展一些自己的东西</p> <p>例如: SQL Server  使用T-SQL</p> <p>​      Oracle      使用PL/SQL</p> <p>​      MySQL       使用MySQL</p> <h3 id="_2-3-sql语句功能划分"><a href="#_2-3-sql语句功能划分" class="header-anchor">#</a> 2.3 SQL语句功能划分</h3> <p>- DDL:数据定义语句</p> <p>​    用来定义数据库对象：创建库，表，列等。</p> <p>- DML：数据操作语句</p> <p>​    用来操作数据库表中的记录</p> <p>- DQL：数据查询语句</p> <p>​    用来查询数据</p> <p>- DCL：数据控制语句</p> <p>​    用来定义访问权限和安全级别</p> <h3 id="_2-4-sql数据类型"><a href="#_2-4-sql数据类型" class="header-anchor">#</a> 2.4 SQL数据类型</h3> <p>和常见的编程语言一样, 数据库中存储的数据也是区分类型的</p> <p>MySQL中支持的数据类型大致可以分为三类: 数值类型、字符串类型和日期和时间类型</p> <p>https://dev.mysql.com/doc/refman/8.0/en/data-types.html</p> <p>MySQL中常用的数据类型如下:</p> <p>double：浮点型，例如double(5,2)表示最多5位，其中必须有2位小数，即最大值为999.99；</p> <p>char：固定长度字符串类型； char(10)  'lnj       '</p> <p>varchar：可变长度字符串类型；varchar(10) 'lnj'</p> <p>text：字符串类型;</p> <p>blob：二进制类型；</p> <p>date：日期类型，格式为：yyyy-MM-dd；</p> <p>time：时间类型，格式为：hh:mm:ss</p> <p>datetime:日期时间类型 yyyy-MM-dd hh:mm:ss</p> <p>注意点: 在mysql中，字符串类型和日期类型都要用单引号括起来。'lnj'  '2022-02-02'</p> <h2 id="_3-数据库的增删改查"><a href="#_3-数据库的增删改查" class="header-anchor">#</a> 3.数据库的增删改查</h2> <h3 id="_3-1-创建数据库"><a href="#_3-1-创建数据库" class="header-anchor">#</a> 3.1 创建数据库</h3> <p>create database [if not exists] 数据库名称 [charset=字符集];</p> <p>示例一:</p> <p>create database stu;</p> <p>注意点: 以上语句, 如果MySQL中已经有了名称叫做stu的数据库, 再执行就会报错</p> <p>示例二:</p> <p>create database if not exists person;</p> <p>注意点: 以上语句, 如果MySQL中已经有了名称叫做person的数据库, 并不会报错, 而是跳过这条语句</p> <p>示例三:</p> <p>create database if not exists it666 charset=utf8;</p> <p>注意点: 为了避免将来读取的字符集和存储的字符集不一样导致乱码问题,</p> <p>在创建数据库的时候, 我们还需要指定当前创建的数据库将来使用什么编码方式存储数据</p> <h4 id="_3-1-1-如何查看数据库全局默认的编码"><a href="#_3-1-1-如何查看数据库全局默认的编码" class="header-anchor">#</a> 3.1.1 如何查看数据库全局默认的编码</h4> <p>show variables like 'character_set_%';</p> <h4 id="_3-1-2-如果查看某个数据库的编码"><a href="#_3-1-2-如果查看某个数据库的编码" class="header-anchor">#</a> 3.1.2 如果查看某个数据库的编码</h4> <p>show create database person;</p> <h4 id="_3-1-3-特殊的数据库名称处理"><a href="#_3-1-3-特殊的数据库名称处理" class="header-anchor">#</a> 3.1.3 特殊的数据库名称处理</h4> <p>create database if not exists <code>create</code> charset=utf8;</p> <p>注意点: 如果数据库的名称是SQL的关键字或者是一些特殊字符#~@*&amp;.., 这个时候就需要用反引号括起来</p> <h3 id="_3-2-如何删除数据库"><a href="#_3-2-如何删除数据库" class="header-anchor">#</a> 3.2 如何删除数据库</h3> <p>drop database [if exists] 数据库名称;</p> <p>示例一:</p> <p>drop database stu;</p> <p>注意点: 以上语句, 如果MySQL中没有要删除的数据库, 那么就会报错</p> <p>示例二:</p> <p>drop database if exists person;</p> <p>注意点: 以上语句, 如果MySQL中没有要删除的数据库, 那么就会跳过, 并不会报错</p> <h3 id="_3-3-如何修改数据库"><a href="#_3-3-如何修改数据库" class="header-anchor">#</a> 3.3 如何修改数据库</h3> <p>alter database 数据库名称 charset=字符集;</p> <p>alter database it666 charset=utf8;</p> <h3 id="_3-4-如何查看数据库"><a href="#_3-4-如何查看数据库" class="header-anchor">#</a> 3.4 如何查看数据库</h3> <p>show create database 数据库名称;</p> <p>show databases;</p> <p>新建-- C/增加</p> <p>create database [if not exists] 数据库名称 [charset=字符集];</p> <p>删除-- D/删除</p> <p>drop database [if exists] 数据库名称;</p> <p>修改-- U/修改</p> <p>alter database 数据库名称 charset=字符编码</p> <p>读取-- R/查看</p> <p>show databases;</p> <p>show create database 数据库名称;</p> <h2 id="_4-表的增删改查"><a href="#_4-表的增删改查" class="header-anchor">#</a> 4.表的增删改查</h2> <p>注意点:</p> <p>在对数据库的表进行操作的时候(增删改查), 都必须先告诉MySQL我们要操作的是哪一个数据库</p> <p>use 数据库名称;</p> <p>1.如何查看数据库中有哪些表?</p> <p>show tables;</p> <p>2.如何查看指定表的结构</p> <p>desc 表名;</p> <h3 id="_4-1-创建表"><a href="#_4-1-创建表" class="header-anchor">#</a> 4.1 创建表</h3> <p>create table 表名(</p> <p>字段名称 数据类型,</p> <p>字段名称 数据类型,</p> <p>字段名称 数据类型,</p> <p>字段名称 数据类型,</p> <p>);</p> <p><strong>示例一:</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> stu<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">text</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意点: 以上代码创建表, 如果表已经存在了, 那么就会报错</p> <p><strong>示例二:</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> person<span class="token punctuation">(</span>
   id <span class="token keyword">int</span><span class="token punctuation">,</span>
   name <span class="token keyword">text</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意点: 以上代码创建表, 没有就会创建一个新的, 有就会自动跳过</p> <h3 id="_4-2-删除表"><a href="#_4-2-删除表" class="header-anchor">#</a> 4.2 删除表</h3> <p>drop table 表名;</p> <p><strong>示例一:</strong></p> <p>drop table stu;</p> <p>注意点: 以上语句, 如果删除的表不存在, 那么就会报错</p> <p><strong>示例二:</strong></p> <p>drop table if exists person;</p> <p>注意点: 以上语句, 如果需要删除的表存在, 那么就直接删除, 如果不存在就跳过</p> <h3 id="_4-3-修改表"><a href="#_4-3-修改表" class="header-anchor">#</a> 4.3 修改表</h3> <p><strong>① 修改表名</strong></p> <p>rename table 原始名称 to 新的名称;</p> <p>rename table stu to person;</p> <p><strong>② 添加字段</strong></p> <p>alter table 表名 add 新增字段名称 新增字段数据类型 [位置];</p> <p>alter table person add age int;</p> <p>注意点: 默认情况下会将新增的字段放到原有字段的后面</p> <p>alter table person add score float first;</p> <p>注意点: 我们可以通过指定first将新增的字段放到原有字段的前面</p> <p>alter table person add phone int after name;</p> <p>注意点: 我们可以通过after指定将新增的字段放到哪个字段的后面</p> <p><strong>③ 删除字段</strong></p> <p>alter table 表名 drop 字段名称;</p> <p>alter table person drop phone;</p> <p><strong>④ 修改字段</strong></p> <p>6.3.1修改字段的数据类型</p> <p>alter table 表名 modify 需要修改的字段名称 新的数据类型</p> <p>alter table person modify score double;</p> <p><strong>⑤ 修改字段的名称和数据类型</strong></p> <p>alter table 表名 change 原始字段名称 新的字段名称 新的数据类型;</p> <p>alter table person change age addr text;</p> <h2 id="_5-mysql存储引擎"><a href="#_5-mysql存储引擎" class="header-anchor">#</a> 5.MySQL存储引擎</h2> <h3 id="_5-1-mysql存储引擎简介"><a href="#_5-1-mysql存储引擎简介" class="header-anchor">#</a> 5.1 MySQL存储引擎简介</h3> <p>①  MySQL中的存储引擎就好比我们现实生活中的银行, 不同的银行提供的安全级别、服务水平、存储功能不一样</p> <p>和现实生活中一样在MySQL也有各种各样不同的银行, 这些银行我们称之为存储引擎</p> <p>和现实生活中一样MySQL中不同的存储引擎提供的安全级别、服务水平、存储功能等也不一样</p> <p>② MySQL中有三种存储引擎, 分别是:</p> <p>​    + MyISAM: 安全性低, 但不支持事务和外键, 适合频繁插入和查询的应用</p> <p>​    + InnoDB(默认): 安全性高, 支持事务和外键, 适合对安全性, 数据完整性要求较高的应用</p> <p>​    + Memory: 访问速度极快, 但不会永久存储数据, 适合对读写速度要求较高的应用</p> <p>create table stu(</p> <p>​    id int,</p> <p>​    name text</p> <p>)engine=引擎名称;</p> <h3 id="_5-2-不同引擎本质"><a href="#_5-2-不同引擎本质" class="header-anchor">#</a> 5.2 不同引擎本质</h3> <p>- 前面我们说过数据库的本质就是文件, 所以我们可以先观察一下</p> <p>- 通过我们的观察, 我们发现只要创建一个数据库就会自动创建一个文件夹</p> <p>- 通过我们的观察, 我们发现只要创建一张表就会在指定的数据库文件夹中创建一个文件</p> <p>- 创建表的时候自动创建的这个文件就保存了这张表的结构</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> stu<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token keyword">engine</span><span class="token operator">=</span>Memory<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>InnoDB:</p> <p>​    - 如果表的存储引擎是InnoDB, 那么只要创建表就会自动创建一个文件, 这个文件就保存了这张表的结构</p> <p>​    - 如果往InnoDB的表中存储数据, 那么数据会被存储到ibdata1的文件中, 如果存储的数据比较多, 那么系统会自动再创建ibdata2, ibdata3, ...文件</p> <p>MyISAM:</p> <p>​    - 如果表的存储引擎是MyISAM, 那么只要创建表就会自动创建三个文件</p> <p>​        + .sdi这个文件就保存了这张表的结构</p> <p>​        + .MYD这个文件就保存了这张表中存储的数据</p> <p>​        + .MYI这个文件就保存了这张表中的索引</p> <p>Memory:</p> <p>​    - 如果表的存储引擎是Memory, 那么只要创建表就会自动创建一个文件, 这个文件就保存了这张表的结构</p> <p>​    - 注意点: 如果表的存储引擎是Memory, 那么就不会像InnoDB/MyISAM将数据保存到文件中了, 而是直接保存到内存中</p> <p>alter table 表名 engine=引擎名称;</p> <p>alter table stu engine=MyISAM;</p> <h2 id="_6-数据增删改查"><a href="#_6-数据增删改查" class="header-anchor">#</a> 6.数据增删改查</h2> <h3 id="_6-1-插入数据"><a href="#_6-1-插入数据" class="header-anchor">#</a> 6.1 插入数据</h3> <p>insert into 表名 (字段名称1, 字段名称2) values (值1, 值2);</p> <p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> stu<span class="token punctuation">(</span>
   id <span class="token keyword">int</span><span class="token punctuation">,</span>
   name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>insert into stu (id, name) values (1, 'lnj');</p> <p># 注意点: 在插入数据的时候指定的字段名称的顺序不用和表中的字段名称的顺序一致</p> <p>insert into stu (name, id) values ('zs', 2);</p> <p># 注意点: 在插入数据的时候指定的取值顺序必须和指定的字段名称顺序一致</p> <p>insert into stu (name, id) values (3, 'ls');</p> <p># 注意点: 如果插入数据时指定的取值顺序和表中的字段顺序是一致的, 那么可以不指定字段名称</p> <p>insert into stu values (3, 'ls');</p> <p># 注意点: 我们可以通过values同时插入多条数据</p> <p>insert into  stu values (4, 'ww'), (5, 'zl');</p> <h3 id="_6-2-更新数据"><a href="#_6-2-更新数据" class="header-anchor">#</a> 6.2 更新数据</h3> <p>update 表名 set 字段名称=值 [where 条件];</p> <p>示例:</p> <p># 注意点: 如果在更新数据的时候没有指定条件, 那么就会更新整张表中的数据</p> <p>update stu set score=77;</p> <p># 注意点: 如果在更新数据的时候指定了条件, 那么只会更新满足条件的数据</p> <p>update stu set score=88 where name='ls';</p> <p># 注意点: 在指定条件的时候, 我们可以通过AND来指定多个条件, AND===&amp;&amp;</p> <p>update stu set score=100 where name='lnj' AND id=5;</p> <p># 注意点: 在指定条件的时候, 我们可以通过OR来指定多个条件, OR===||</p> <p>update stu set score=66 where name='zs' OR name='ww';</p> <p># 注意点: 在更新数据的时候是可以同时更新多个字段的</p> <p>update stu set name='it666', score=33 where id=5;</p> <h3 id="_6-3-查询表"><a href="#_6-3-查询表" class="header-anchor">#</a> 6.3 查询表</h3> <p># 注意点: 以下方式会将表中所有的数据都查询出来, 所以性能比较差</p> <p># 注意点: 以下方式会将表中所有的数据都查询出来, 不能查询特定字段的值</p> <p>select * from 表名;</p> <p># 以下才是查询数据完整的写法</p> <p>select 字段名称1, 字段名称2 from 表名 [where 条件];</p> <p># 查询特定字段的数据</p> <p>select name from stu;</p> <p># 查询满足条件的数据</p> <p>select * from stu where score &gt; 60;</p> <p>select id, name from stu where score &gt; 60;</p> <p>select * from stu where score = 77 || score = 88;</p> <p>select * from stu where score in (77, 88);</p> <p>select * from stu where score BETWEEN 77 AND 88;</p> <p>select * from stu where score IS NOT NULL;</p> <p>select * from stu where score IS NULL;</p> <p>where支持的运算符</p> <p>=（等于）、!=（不等于）、&lt;&gt;（不等于）、&lt;（小于）、&lt;=（小于等于）、&gt;（大于）、&gt;=（大于等于）；</p> <p>IN(set)；固定的范围值</p> <p>BETWEEN…AND；值在什么范围</p> <p>IS NULL；（为空） IS NOT NULL（不为空）</p> <p>AND；与</p> <p>OR；或</p> <p>NOT；非</p> <p>LIKE: 模糊查询</p> <h3 id="_6-4-删除数据"><a href="#_6-4-删除数据" class="header-anchor">#</a> 6.4 删除数据</h3> <p>delete from 表名 [where 条件];</p> <p># 删除满足条件的数据</p> <p>delete from stu where score &gt; 60;</p> <p>$ 删除所有的数据</p> <p>delete from stu;</p> <h2 id="_7-数据类型"><a href="#_7-数据类型" class="header-anchor">#</a> 7.数据类型</h2> <h3 id="_7-1-mysql为什么要提供数据类型"><a href="#_7-1-mysql为什么要提供数据类型" class="header-anchor">#</a> 7.1 MySQL为什么要提供数据类型?</h3> <p>如果没有数据类型, 那么MySQL就不知道需要分配多大的存储空间来存储你的数据</p> <p>过大会浪费会造成资源浪费, 体积变大效率变低, 过小可能导致数据溢出不能完整的保存数据</p> <p>所以MySQL提供数据类型的目的是为了让我们合理的分配存储空间, 降低数据库的体积</p> <p>​                             为了让我们合理的分配存储空间, 完整的保存数据</p> <p>​                             为了更好的对数据库进行优化</p> <h3 id="_7-2-mysql中有哪些数据类型"><a href="#_7-2-mysql中有哪些数据类型" class="header-anchor">#</a> 7.2. MySQL中有哪些数据类型?</h3> <p>- 整型类型/浮点类型/定点类型/字符类型/文本类型/枚举类型/集合类型/日期类型/布尔类型</p> <h4 id="_7-2-1-整数类型-专门用来保存整数的"><a href="#_7-2-1-整数类型-专门用来保存整数的" class="header-anchor">#</a> 7.2.1 整数类型 - 专门用来保存整数的</h4> <p>TINYINT         1 字节    (-128，127)  (0，255) 小整数值</p> <p>SMALLINT        2 字节    (-32 768，32 767)    (0，65 535)  大整数值</p> <p>MEDIUMINT       3 字节    (-8 388 608，8 388 607)  (0，16 777 215)  大整数值</p> <p>INT或INTEGER 4 字节    (-2 147 483 648，2 147 483 647)  (0，4 294 967 295)   大整数值</p> <p>BIGINT          8 字节    (-9,223,372,036,854,775,808，9 223 372 036 854 775 807)  (0，18 446 744 073 709 551 615)  极大整数值</p> <p>注意点:</p> <p>​    - MySQL中的整型和其它编程语言的整型一样, 也区分有符号和无符号</p> <p>​        + 默认情况下整型就是有符号的</p> <p>​        + 我们可以在数据类型的后面加上 unsigned 来将数据类型变成无符号的</p> <p>​    - 在设计数据库的时候一定要合理的使用数据类型</p> <p>​        + 例如: 我们要保存一个人的年龄 (整数)</p> <p>​        +       我们应该使用TINYINT类型, 因为人最多活到255岁已经上天了, 所以使用最小的整型即可</p> <p>​        +       如果使用其它的整型, 就会造成资源浪费, 数据库体积变大, 效率变低...</p> <p>​    - 在保存数据的时候, 如果超出了当前数据类型的范围, 那么就会报错</p> <p>​    - 在设置整型的时候, 还可以设置整型数据将来显示的位宽</p> <p>​        + 例如: 现在设置将来显示整型的位宽是2, 现在存储的数据1, 那么将来查询出来的数据就会显示成 1;</p> <p>​        + 2020-2-3 -- 2020-02-03</p> <p>​        + 注意点: 如果存储的数据没有指定的位宽宽, 那么就会自动补空格或者0, 如果大于或者等于了指定的位宽, 那么毛都不做</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  age <span class="token keyword">tinyint</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  age <span class="token keyword">tinyint</span> <span class="token keyword">unsigned</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person3<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  age <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> zerofill
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">#01</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">#12</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#123</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_7-2-2-浮点类型-专门用来保存小数的"><a href="#_7-2-2-浮点类型-专门用来保存小数的" class="header-anchor">#</a> 7.2.2 浮点类型 - 专门用来保存小数的</h4> <p>FLOAT(m, d)     4 字节    单精度</p> <p>DOUBLE(m, d)    8 字节    双精度</p> <p>m总位数, d小数位数</p> <p>- float和double的区别</p> <p>​    + 占用存储空间大小不一样</p> <p>​    + 默认保留的小数位数不同</p> <p>​    + 保存数据的有效精度也不同</p> <p>- 浮点类型特点</p> <p>​    + 和其它编程语言中一样, 浮点类型是不准确的</p> <p>​    + 所以在企业开发中千万不要使用浮点数来保存用户的准确(珍贵)信息(RMB)</p> <p>示例一: 默认保留的小数位数不同</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  weight <span class="token keyword">FLOAT</span><span class="token punctuation">,</span>
  height <span class="token keyword">DOUBLE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weight: <span class="token number">1.12346</span>
height: <span class="token number">1.1234567890123457</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>示例二: 手动指定小数的总位数和小数部分的位数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  weight <span class="token keyword">FLOAT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  height <span class="token keyword">DOUBLE</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weight: <span class="token number">1.123457</span>
height: <span class="token number">1.123457</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>示例三: 保存数据的有效精度也不同</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person3<span class="token punctuation">(</span>
   id <span class="token keyword">int</span><span class="token punctuation">,</span>
   weight <span class="token keyword">FLOAT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   height <span class="token keyword">DOUBLE</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person3 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weight: <span class="token number">1.123456</span><span class="token operator">-</span><span class="token number">8357467651000</span>

height: <span class="token number">1.123456789012345</span><span class="token operator">-</span><span class="token number">7000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_7-2-3-定点类型-也是用于存储小数的"><a href="#_7-2-3-定点类型-也是用于存储小数的" class="header-anchor">#</a> 7.2.3.定点类型 - 也是用于存储小数的</h4> <p>decimal(M, D)</p> <p>m总位数, d小数位数</p> <p>定点类型的本质: 是将数据分为两个部分来存储, 每个部分都是整数</p> <p>​                所以定点数不要滥用, 因为非常消耗资源</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person4<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  weight <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  height <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person4 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">,</span> <span class="token number">1.12345678901234567890</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weight: <span class="token number">1.12345678901234567890</span>
height: <span class="token number">1.12345678901234567890</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_7-2-4-字符类型-专门用来存储字符的"><a href="#_7-2-4-字符类型-专门用来存储字符的" class="header-anchor">#</a> 7.2.4 字符类型 - 专门用来存储字符的</h4> <p>CHAR(size)     0-255  字节       定长字符串</p> <p>VARCHAR(size)  0-65535字节       变长字符串</p> <p>- char和varchar区别</p> <p>​    + 能够保存数据的容量不一样</p> <p>​    + char不会回收多余的字符,  要多少给多少</p> <p>​    + varchar会回收多余的字符, 用多少给多少</p> <p>​        + 例如: 通过    char(2)存储存储数据'a', 存储的结果是' a';</p> <p>​        + 例如: 通过 varchar(2)存储存储数据'a', 存储的结果是'a';</p> <p>示例一:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name1 <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  name2 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">,</span> <span class="token string">'34'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'abc'</span><span class="token punctuation">,</span> <span class="token string">'def'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#只要超出申请的范围就会报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>示例二:</p> <p>注意点: 由于是字符类型, 所以传递值建议用单引号''</p> <p>注意点: VARCHAR理论上可以存储65535个字符, 但是实际会随着当前数据库的字符集改变</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name1 <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  name2 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p># 65535 / 3 = 21845, 由于utf8一个字符占用3个字节, 所以varchar在utf8的表中最多只能存储21845个字符</p> <p># 65535 / 2 = 32767, 由于gbk一个字符占用2个字节,所以varchar在gbk的表中最多只能存储32767个字符</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person3<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name1 <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  name2 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">65535</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token keyword">charset</span><span class="token operator">=</span>gbk<span class="token punctuation">;</span>
<span class="token keyword">Column</span> length too big <span class="token keyword">for</span> <span class="token keyword">column</span> <span class="token string">'name2'</span> <span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">21845</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">use</span> <span class="token keyword">BLOB</span> <span class="token operator">or</span> <span class="token keyword">TEXT</span> instead
<span class="token keyword">Column</span> length too big <span class="token keyword">for</span> <span class="token keyword">column</span> <span class="token string">'name2'</span> <span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">32767</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">use</span> <span class="token keyword">BLOB</span> <span class="token operator">or</span> <span class="token keyword">TEXT</span> instead
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_7-2-5-大文本类型"><a href="#_7-2-5-大文本类型" class="header-anchor">#</a> 7.2.5 大文本类型</h4> <p>① MySQL中每一行存储的数据是有大小限制的, 每一行最多只能存储65534个字节</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
<span class="token comment">#name1 char(3),</span>
name2 <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">21844</span><span class="token punctuation">)</span> <span class="token comment">#在UTF8中相当于65535个字节</span>
<span class="token punctuation">)</span><span class="token keyword">charset</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>

<span class="token comment"># Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>② 大文本类型</p> <p>TINYTEXT   0-255字节         短文本字符串</p> <p>TEXT       0-65535字节           长文本数据</p> <p>MEDIUMTEXT 0-16777215字节        中等长度文本数据</p> <p>LONGTEXT   0-4294967295字节    极大文本数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
  name1 <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  name2 <span class="token keyword">TEXT</span> <span class="token comment">#不会报错, 因为没有超出显示, 实际只占用10个字节</span>
<span class="token punctuation">)</span><span class="token keyword">charset</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意点:</p> <p>大文本类型在表中并不会实际占用所能保存的字节数, 而是利用10个字节引用了实际保存数据的地址</p> <h4 id="_7-2-6-枚举类型"><a href="#_7-2-6-枚举类型" class="header-anchor">#</a> 7.2.6 枚举类型</h4> <p>和其它编程语言一样, 如果某个字段的取值只能是几个固定值中的一个, 那么就可以使用枚举</p> <p>enum(值1, 值2, ...);</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  gender <span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'妖'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'火'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#会报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'妖'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>注意点:</p> <p>- MySQL中的枚举类型和其它的编程语言一样, 底层都是使用整型来实现的</p> <p>​    + 和其它编程语言不太一样的是, 其它编程语言的枚举都是从0开始的, 而MySQL的枚举是从1开始的</p> <p>select gender+0 from person;</p> <p>- 由于MySQL的枚举底层是使用整型实现的, 所以我们在赋值的时候除了可以赋值固定的几个值其中的一个意外</p> <p>我们还可以赋值对应的整数</p> <p>insert into person values (4, 1); #不会报错</p> <p>insert into person values (4, 4); #会报错</p> <h4 id="_7-2-7-集合类型"><a href="#_7-2-7-集合类型" class="header-anchor">#</a> 7.2.7 集合类型</h4> <p>和编程开发中一样, 如果某个字段的取值只能是几个固定值中的几个, 那么就可以使用集合类型</p> <p>set(值1, 值2, ...)</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  hobby <span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'篮球'</span><span class="token punctuation">,</span><span class="token string">'足球'</span><span class="token punctuation">,</span><span class="token string">'高尔夫球'</span><span class="token punctuation">,</span><span class="token string">'足浴'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'篮球,足球,高尔夫球'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'橄榄球'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">#会报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'篮球'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错  1</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'足球'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错  2</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'高尔夫球'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错  4</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'足浴'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错  8</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>注意点:</p> <p>- MySQL的集合类型也是使用整型来实现的</p> <p>select hobby+0 from person;</p> <p>- MySQL的集合类型是按照2(n)的方式来实现的</p> <p>2(0) = 1</p> <p>2(1) = 2</p> <p>2(2) = 4</p> <p>2(3) = 8</p> <h4 id="_7-2-8-布尔类型-专门用来保存真假的"><a href="#_7-2-8-布尔类型-专门用来保存真假的" class="header-anchor">#</a> 7.2.8 布尔类型 - 专门用来保存真假的</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  flag <span class="token keyword">boolean</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#会报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#不会报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>注意点:</p> <p>- MySQL中的布尔类型也是使用整型来实现的, 0就表示假, 1就表示真</p> <p>​    + 底层的本质是因为MySQL是使用C/C++来实现的, 所以就是'非零即真'</p> <p>insert into person values (3, 1); #不会报错</p> <p>insert into person values (4, 0); #不会报错</p> <p>insert into person values (5, 2); #不会报错</p> <h4 id="_7-2-8-日期类型-专门用来保存时间的"><a href="#_7-2-8-日期类型-专门用来保存时间的" class="header-anchor">#</a> 7.2.8 日期类型 - 专门用来保存时间的</h4> <p>DATE       3字节 YYYY-MM-DD  日期值</p> <p>TIME       3字节 HH:MM:SS    时间值或持续时间</p> <p>DATETIME   8字节 YYYY-MM-DD HH:MM:SS 混合日期和时间值</p> <p>注意点: 在存储时间的时候, 需要用单引号将时间括起来</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  filed1 <span class="token keyword">DATE</span><span class="token punctuation">,</span>
  filed2 <span class="token keyword">TIME</span><span class="token punctuation">,</span>
  filed3 <span class="token keyword">DATETIME</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02'</span><span class="token punctuation">,</span> <span class="token string">'14:18:23'</span><span class="token punctuation">,</span> <span class="token string">'2020-02-02 14:18:23'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_8-数据完整性"><a href="#_8-数据完整性" class="header-anchor">#</a> 8.数据完整性</h2> <h3 id="_8-1-数据完整性介绍"><a href="#_8-1-数据完整性介绍" class="header-anchor">#</a> 8.1 数据完整性介绍</h3> <p>① 什么是数据的完整性?</p> <p>保证保存到数据库中的数据都是正确的。</p> <p>② 如何保证数据完整性?</p> <p>- 数据的完整性可以分为三类: 实体完整性、域完整性、参照完整性</p> <p>- 无论是哪一种完整性都是在创建表时给表添加约束即可</p> <h3 id="_8-2-实体完整性"><a href="#_8-2-实体完整性" class="header-anchor">#</a> 8.2 实体完整性</h3> <h4 id="_8-2-1-什么是实体"><a href="#_8-2-1-什么是实体" class="header-anchor">#</a> 8.2.1 什么是实体?</h4> <p>​    表中的一行数据就是一个实体（entity）</p> <h4 id="_8-2-2-如何保证实体完整性"><a href="#_8-2-2-如何保证实体完整性" class="header-anchor">#</a> 8.2.2 如何保证实体完整性?</h4> <p>​    保证实体完整性就是保证每一行数据的唯一性</p> <h4 id="_8-2-3-实体完整性的约束类型"><a href="#_8-2-3-实体完整性的约束类型" class="header-anchor">#</a> 8.2.3 实体完整性的约束类型</h4> <p>​    主键约束（primary key）</p> <p>​    唯一约束(unique)</p> <p>​    自动增长列(auto_increment)</p> <h4 id="_8-2-4-主键约束-primary-key"><a href="#_8-2-4-主键约束-primary-key" class="header-anchor">#</a> 8.2.4 主键约束（primary key）</h4> <p>主键用于唯一标识表中的每一条数据, 和现实生活中的身份证很像</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>主键的特征:</p> <p>- 如果将某一个字段设置成了主键, 那么这个字段的取值就不能重复了</p> <p>- 如果将某一个字段设置成了主键, 那么这个字段的取值就不能是null了</p> <p>- 一张表中只能有一个主键, 不能出现多个主键</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person3<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>- 我们除了可以在字段数据类型后面添加primary key, 将这个字段变成主键以外,</p> <p>还可以通过在最后写上primary key(字段名称)的方式来指定主键</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person3<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person3 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person3 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_8-3-联合主键"><a href="#_8-3-联合主键" class="header-anchor">#</a> 8.3 联合主键</h3> <p>我们通过将表中的某个永远不重复的字段设置为主键, 从而达到保证每一行数据的唯一性(实体完整性)</p> <p>但是在企业开发中有时候我们可能找不到不重复的字段, 此时我们还可以通过联合主键的方式来保证每一行数据的唯一性</p> <p>联合主键就是同时将多个字段作为一个主键来使用</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
   name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   age <span class="token keyword">int</span><span class="token punctuation">,</span>
   <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'lnj'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'lnj'</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>注意点:</p> <p>联合主键并不是添加多个主键, 而是将多个字段的值作为主键来使用</p> <p>也就是过去我们指定id为主键, 那么id的取值不能重复</p> <p>而现在如果我们指定 name和age为主键, 那么name+age的值不能重复</p> <h3 id="_8-4-唯一约束-unique"><a href="#_8-4-唯一约束-unique" class="header-anchor">#</a> 8.4 唯一约束(unique)</h3> <p>唯一约束用于保证某个字段的值永远不重复</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>主键和唯一键异同:</p> <ul><li><p>唯一约束和主键约束一样, 被约束的字段的取值都不能够重复</p></li> <li><p>主键在一张表中只能有一个, 而唯一约束在一张表中可以有多个</p></li> <li><p>主键的取值不能为Null, 而唯一约束的取值可以是Null</p></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
   id <span class="token keyword">int</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
   name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">unique</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_8-5-自动增长约束-auto-increment"><a href="#_8-5-自动增长约束-auto-increment" class="header-anchor">#</a> 8.5 自动增长约束(auto_increment)</h3> <p>自动增长约束的作用是让某个字段的取值从1开始递增, 从而保证实体完整性</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
   id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
   name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">#Incorrect table definition; there can be only one auto column and it must be defined as a key</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>注意点:</p> <p>如果某个字段是自动增长的, 那么这个字段必须是主键才可以</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果仅仅是主键, 那么取值不能是null, 但是如果主键是自动增长的, 那么取值就可以是null或者default</p> <p>在企业开发中我们应该如何选择主键</p> <p>最少性: 能用一个字段作为主键, 就不要使用多个字段</p> <p>稳定性: 能用不被操作(修改)的字段作为主键, 就不要使用会被操作的字段作为主键</p> <p>一般情况下我们会定义一个名称叫做id的字段, 并且这个字段是整型的, 并且这个字段是自动增长的来作为主键</p> <h3 id="_8-6-如何修改约束"><a href="#_8-6-如何修改约束" class="header-anchor">#</a> 8.6 如何修改约束</h3> <h4 id="_8-6-1-如何修改主键约束"><a href="#_8-6-1-如何修改主键约束" class="header-anchor">#</a> 8.6.1 如何修改主键约束</h4> <p><code>alter table 表名 add primary key(字段);</code></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> person <span class="token keyword">add</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_8-6-2-如何修改唯一约束"><a href="#_8-6-2-如何修改唯一约束" class="header-anchor">#</a> 8.6.2 如何修改唯一约束</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">add</span> <span class="token keyword">unique</span><span class="token punctuation">(</span>字段<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> person2 <span class="token keyword">add</span> <span class="token keyword">unique</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_8-6-3-如何修改自动增长约束"><a href="#_8-6-3-如何修改自动增长约束" class="header-anchor">#</a> 8.6.3 如何修改自动增长约束</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">modify</span> 字段名称 数据类型 <span class="token keyword">auto_increment</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> person3<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> person3 <span class="token keyword">modify</span> id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person3 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'lnj'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_8-7-域完整性"><a href="#_8-7-域完整性" class="header-anchor">#</a> 8.7 域完整性</h3> <h4 id="_8-7-1-什么是域"><a href="#_8-7-1-什么是域" class="header-anchor">#</a> 8.7.1 什么是域?</h4> <p>一行数据中的每个单元格都是一个域</p> <h4 id="_8-7-2-如何保证域的完整性"><a href="#_8-7-2-如何保证域的完整性" class="header-anchor">#</a> 8.7.2 如何保证域的完整性?</h4> <p>保证域的完整性就是保证每个单元格数据的正确性</p> <p>-使用正确的数据类型</p> <p>​    + 例如: 人的年龄不可能超过255岁, 而且不能是负数, 所以我们就可以使用 TINYINT UNSIGNED</p> <p>​    + 例如: 人的性别只能是男/女或者妖, 所以我们就可以使用枚举类型</p> <p>​    + 例如: 要存储比较多的文字, 为了保证不超出每一行最大的存储限制, 我们就可以使用大文本类型</p> <p>-使用非空约束（not null）</p> <p>-使用默认值约束(default)</p> <p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> person<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> person2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">'it666'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> person2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'zs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>注意点: 哪怕设置了默认值, 传入null之后也不会使用默认值</p> <h3 id="_8-8-参照完整性"><a href="#_8-8-参照完整性" class="header-anchor">#</a> 8.8 参照完整性</h3> <p>参照完整性又称引用完整性, 主要用于保证多表之间引用关系的正确性</p> <h4 id="_8-8-1-为什么要创建多张表"><a href="#_8-8-1-为什么要创建多张表" class="header-anchor">#</a> 8.8.1 为什么要创建多张表?</h4> <p>示例: 定义一张表保存2个学生3门课程的成绩</p> <p><code>| id | name | gender | km | score |</code></p> <p>如果将所有的数据都放到一张表中, 会出现大量冗余数据</p> <p>所以为了降低数据库的体积, 提升数据库的效率, 我们需要根据自身需求对表进行拆分</p> <h4 id="_8-8-2-什么时候会出现冗余数据"><a href="#_8-8-2-什么时候会出现冗余数据" class="header-anchor">#</a> 8.8.2 什么时候会出现冗余数据?</h4> <p>- 表与表之间的关系可以分为三种: 一对一、一对多、多对多</p> <p>① 一对一(一般不需要拆分):</p> <p>② 一对多(一般需要拆分):</p> <p>③ 多对多(一般需要拆分):</p> <h4 id="_8-8-3-如何保证参照完整性"><a href="#_8-8-3-如何保证参照完整性" class="header-anchor">#</a> 8.8.3 如何保证参照完整性?</h4> <p>默认情况下表与表之间是独立存在的, 不会相互影响</p> <p>也正是因为如此, 默认情况下也不会检查表与表之间的依赖关系</p> <p>所以为了保证表与表之间参照完整性, 我们可以通过'外键'来保证参照完整性</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> stu<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  gender <span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'妖'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> grade<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  km <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  score <span class="token keyword">double</span><span class="token punctuation">,</span>
  uid <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stu <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'zs'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_8-8-4-什么是外键"><a href="#_8-8-4-什么是外键" class="header-anchor">#</a> 8.8.4 什么是外键</h4> <p>如果一张表中有一个字段指向了别一张表中的主键，就将该字段叫做外键</p> <p>例如: 成绩表中的uid引用了学生表中的id, 那么成绩表中的uid我们就称之为外键</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> grade2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  km <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  score <span class="token keyword">double</span><span class="token punctuation">,</span>
  uid <span class="token keyword">int</span><span class="token punctuation">,</span>
  <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">references</span> stu<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade2 <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'数学'</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>外键注意点:</strong></p> <p>- 只有InnoDB的存储引擎才支持外键约束</p> <p>- 外键的数据类型必须和指向的主键一样</p> <p>- 在一对多的关系中, 外键一般定义在多的一方(一个学生有多门成绩, 那么外键定义在成绩表中)</p> <p>- 定义外键的表我们称之为从表, 被外键引用的表我们称之为主表</p> <h4 id="_8-8-5-创建表时定义外键"><a href="#_8-8-5-创建表时定义外键" class="header-anchor">#</a> 8.8.5 创建表时定义外键</h4> <p>foreign key(外键字段名称) references 主表名称(主表主键名称);</p> <p><strong>① 如何动态添加外键</strong></p> <p>alter table 从表名称 add foreign key(外键字段名称) references 主表名称(主表主键名称);</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> grade<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  km <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  score <span class="token keyword">double</span><span class="token punctuation">,</span>
  uid <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> grade <span class="token keyword">add</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">references</span> stu<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>② 如何查看外键是谁</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">table</span> 从表名称<span class="token punctuation">;</span>

<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">table</span> grade<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>grade<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>km<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>score<span class="token punctuation">`</span></span> <span class="token keyword">double</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>uid<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>uid<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>uid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">CONSTRAINT</span> <span class="token identifier"><span class="token punctuation">`</span>grade_ibfk_1<span class="token punctuation">`</span></span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>uid<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token identifier"><span class="token punctuation">`</span>stu<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>注意点:</p> <p>- CONSTRAINT <code>grade_ibfk_1</code> FOREIGN KEY (<code>uid</code>) REFERENCES <code>stu</code> (<code>id</code>)含义</p> <p>​    + 将uid变成外键, 外键的名称是grade_ibfk_1</p> <p>​    + uid的取值引用的是stu这张表中的id字段的值</p> <p><strong>③ 如何动态删除外键</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> 从表名称 <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> 外键名称<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> grade <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> grade_ibfk_1<span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>- <strong>严格操作</strong>: (前面讲解的都是严格操作)</p> <p>​    + 主表不存在对应数据,从表不允许添加</p> <p>​        + insert into grade values (null, '语文', 100, 3);</p> <p>​    + 从表引用着数据,主表不允许删除</p> <p>​        + delete from stu where id=1;</p> <p>​    + 从表引用这数据, 主表不允许修改</p> <p>​        + update stu set id=3 where id=1;</p> <p>- <strong>置空操作(null)</strong>  : on delete set null</p> <p>​    + 在企业开发中, 我们可能必须要删除主表中的数据, 但是如果主表被删除了从表就不完整了</p> <p>​    + 所以在企业开发中, 我们可以通过置空操作, 在删除主表数据的同时删除从表关联的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> grade2<span class="token punctuation">(</span>
   id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
   km <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   score <span class="token keyword">double</span><span class="token punctuation">,</span>
   uid <span class="token keyword">int</span><span class="token punctuation">,</span>
   <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">references</span> stu<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">set</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>- <strong>级联操作(cascade)</strong>:</p> <p>​    + 在企业开发中, 我们可能必须要修改主表中的数据, 但是如果主表被修改了从表就不完整了</p> <p>​    + 所以在企业开发中, 我们可以通过'级联操作', 在修改主表数据的同时修改从表关联的数据</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> grade3<span class="token punctuation">(</span>
  id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  km <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  score <span class="token keyword">double</span><span class="token punctuation">,</span>
  uid <span class="token keyword">int</span><span class="token punctuation">,</span>
  <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">references</span> stu<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> grade <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'语文'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> stu <span class="token keyword">set</span> id<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>[constraint 外键名称] foreign key(外键字段) references 主表(主键)[主表删除的动作][主表更新的动作]</p> <p>一般情况下主表删除时从表置空, 主表更新时从表级联</p> <h4 id="_8-8-5-多对多外键"><a href="#_8-8-5-多对多外键" class="header-anchor">#</a> 8.8.5 多对多外键</h4> <p>​        学生表                                                      关系表                                           教师表</p> <p><code>| id | stuName | gender | | stuId | teacherId | | id | stuName | gender |</code></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> stu<span class="token punctuation">(</span>
   id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
   name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   gender <span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'妖'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stu <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stu <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> teacher<span class="token punctuation">(</span>
   id <span class="token keyword">int</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
   name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   gender <span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'妖'</span><span class="token punctuation">)</span>

<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'赵六'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> teacher <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'周七'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> rel<span class="token punctuation">(</span>
   stuId <span class="token keyword">int</span><span class="token punctuation">,</span>
   teacherId <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#报错</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> rel <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#报错</span>

<span class="token keyword">alter</span> <span class="token keyword">table</span> rel <span class="token keyword">add</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>stuId<span class="token punctuation">)</span> <span class="token keyword">references</span> stu<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> rel <span class="token keyword">add</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>teacherId<span class="token punctuation">)</span> <span class="token keyword">references</span> teacher<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="_9-单表查询"><a href="#_9-单表查询" class="header-anchor">#</a> 9.单表查询</h2> <h3 id="_9-1-单表查询的介绍"><a href="#_9-1-单表查询的介绍" class="header-anchor">#</a> 9.1 单表查询的介绍</h3> <p>select * from 表名; #查询表中所有数据</p> <p>select 字段1, 字段2 from 表名; #查询表中指定字段数据</p> <p>select [* || 字段] from 表名 [where 条件]; #查询表中满足条件的数据</p> <h4 id="_9-1-2-什么是结果集"><a href="#_9-1-2-什么是结果集" class="header-anchor">#</a> 9.1.2 什么是结果集?</h4> <p>通过查询语句查询出来的结果我们就称之为结果集</p> <p>结果集以表的形式将查询的结果返回给我们</p> <p><strong>注意点:</strong></p> <p>结果集返回的表和查询的表不是同一张表</p> <p>被查询的表是真实存在的, 是存储在磁盘上的</p> <p>而结果集不是真实存在的, 是存储到内存中的</p> <h4 id="_9-1-3-如何给结果集的字段别名"><a href="#_9-1-3-如何给结果集的字段别名" class="header-anchor">#</a> 9.1.3 如何给结果集的字段别名</h4> <p>- 查询指定字段数据时, 我们可以通过as给指定字段取别名</p> <p><code>SELECT name as MyName, age as MyAge FROM stu;</code></p> <h4 id="_9-1-4-什么是字段表达式"><a href="#_9-1-4-什么是字段表达式" class="header-anchor">#</a> 9.1.4 什么是字段表达式</h4> <p>- 查询数据的时候, 除了可以查询指定字段的数据以外, 我们还可以查询表达式的结果</p> <p>SELECT 6+6;</p> <h4 id="_9-1-5-什么是伪表"><a href="#_9-1-5-什么是伪表" class="header-anchor">#</a> 9.1.5 什么是伪表?</h4> <p>- 字段表达式虽然能够查询出表达式的结果, 但是不符合MySQL的规范</p> <p>- 所以我们可以通过伪表(dual)的方式让字段表达式符合MySQL的规范</p> <p>SELECT 6+6 from dual;</p> <h3 id="_9-2-模糊查询"><a href="#_9-2-模糊查询" class="header-anchor">#</a> 9.2 模糊查询</h3> <p><strong>格式:</strong></p> <p>select 字段 from 表名 where 字段 like '条件';</p> <p><strong>通配符</strong></p> <p>_ 通配符: 表示任意一个字符</p> <p>% 通配符: 表示任意0~n个字符</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'z_'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'z__'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> name <span class="token operator">like</span> <span class="token string">'z_%'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_9-3-排序-order-by"><a href="#_9-3-排序-order-by" class="header-anchor">#</a> 9.3 排序 order by</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> 字段 <span class="token keyword">from</span> 表名 <span class="token keyword">order</span> <span class="token keyword">by</span> 字段 <span class="token punctuation">[</span><span class="token keyword">asc</span> <span class="token operator">|</span> <span class="token keyword">desc</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">order</span> <span class="token keyword">by</span> age<span class="token punctuation">;</span> <span class="token comment">#默认按照升序进行排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">asc</span><span class="token punctuation">;</span> <span class="token comment"># 升序排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">desc</span><span class="token punctuation">;</span> <span class="token comment"># 降序排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">order</span> <span class="token keyword">by</span> age <span class="token keyword">desc</span><span class="token punctuation">,</span> score <span class="token keyword">asc</span><span class="token punctuation">;</span> <span class="token comment">#如果年龄相同, 那么还可以继续按照其它字段来排序</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_9-4-内置函数"><a href="#_9-4-内置函数" class="header-anchor">#</a> 9.4 内置函数</h3> <h4 id="_9-4-1-聚合函数"><a href="#_9-4-1-聚合函数" class="header-anchor">#</a> 9.4.1 聚合函数</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 统计
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> stu<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span><span class="token punctuation">;</span>

<span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 求和
<span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">from</span> stu<span class="token punctuation">;</span>

<span class="token function">avg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 求平均值
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">from</span> stu<span class="token punctuation">;</span> <span class="token comment"># 21 / 6 = 3.5</span>
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">from</span> stu<span class="token punctuation">;</span>

<span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 获取最大值
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">from</span> stu<span class="token punctuation">;</span>

<span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 获取最小值
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">from</span> stu<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_9-4-2-数值类"><a href="#_9-4-2-数值类" class="header-anchor">#</a> 9.4.2 数值类</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#生成随机数</span>
<span class="token keyword">select</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">order</span> <span class="token keyword">by</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#四舍五入</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token number">3.1</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token number">3.5</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

ceil<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#向上取整</span>
<span class="token keyword">select</span> ceil<span class="token punctuation">(</span><span class="token number">3.1</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

floor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#向下取整</span>
<span class="token keyword">select</span> floor<span class="token punctuation">(</span><span class="token number">3.9</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

<span class="token keyword">truncate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#截取小数位</span>
<span class="token keyword">select</span> <span class="token keyword">truncate</span><span class="token punctuation">(</span><span class="token number">3.1234567</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_9-4-3-字符串类"><a href="#_9-4-3-字符串类" class="header-anchor">#</a> 9.4.3 字符串类</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token function">ucase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#转换为大写</span>
<span class="token keyword">select</span> <span class="token function">ucase</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

<span class="token function">lcase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#转换为小写</span>
<span class="token keyword">select</span> <span class="token function">lcase</span><span class="token punctuation">(</span><span class="token string">'HELLO WORLD'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

<span class="token keyword">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#从左边开始截取到指定的位置</span>
<span class="token keyword">select</span> <span class="token keyword">left</span><span class="token punctuation">(</span><span class="token string">'1234567890'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

<span class="token keyword">right</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">#从右边开始截取到指定的位置</span>
<span class="token keyword">select</span> <span class="token keyword">right</span><span class="token punctuation">(</span><span class="token string">'1234567890'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

substring<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#从指定位置开始截取指定个字符</span>
<span class="token keyword">select</span> substring<span class="token punctuation">(</span><span class="token string">'1234567890'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_9-5-数据分组-group-by"><a href="#_9-5-数据分组-group-by" class="header-anchor">#</a> 9.5 数据分组 group by</h3> <p>select 分组字段 || 聚合函数 from 表名 group by 分组字段;</p> <p>id  name  age  score city</p> <p>- 需求: 要求统计表中一共有多少个城市</p> <p>select city from stu;  有重复</p> <p>select city from stu group by city;  去重</p> <p>- 需求: 要求统计每个城市中有多少个人</p> <p>select city, count(*) from stu group by city;</p> <p>**注意点:**P42</p> <p>- 在对数据进行分组的时候, select 后面必须是分组字段或者聚合函数, 否则就只会返回第一条数据</p> <p>select city from stu group by city;  正确</p> <p>select name from stu group by city;  当数据的city相同时，只能获取到第一条，后面重复的会被忽略</p> <p>select city, group_concat(name) from stu group by city;    第二个字段为来自同一个城市的所有人</p> <h3 id="_9-6-条件查询-having"><a href="#_9-6-条件查询-having" class="header-anchor">#</a> 9.6 条件查询 having</h3> <p>- having和where很像都是用来做条件查询的</p> <p>- 但是where是去数据库中查询符合条件的数据, 而having是去结果集中查询符合条件的数据</p> <p>id  name  age  score city</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> city<span class="token operator">=</span><span class="token string">'北京'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">having</span> city<span class="token operator">=</span><span class="token string">'北京'</span><span class="token punctuation">;</span>
<span class="token comment"># 即先select * from stu， 然后从结果中获取city='北京'</span>

<span class="token keyword">select</span> name<span class="token punctuation">,</span> age <span class="token keyword">from</span> stu <span class="token keyword">where</span> city<span class="token operator">=</span><span class="token string">'北京'</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span> age <span class="token keyword">from</span> stu <span class="token keyword">having</span> city<span class="token operator">=</span><span class="token string">'北京'</span><span class="token punctuation">;</span> <span class="token comment">#报错</span>
<span class="token comment">#Unknown column 'city' in 'having clause'（结果集中没有city字段）</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code>统计表中一共有多少个城市: <span class="token keyword">select</span> city <span class="token keyword">from</span> stu <span class="token keyword">group</span> <span class="token keyword">by</span> city<span class="token punctuation">;</span>
统计每个城市的平均分: <span class="token keyword">select</span> city<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">from</span> stu <span class="token keyword">group</span> <span class="token keyword">by</span> city<span class="token punctuation">;</span>
统计每个城市的平均分: <span class="token keyword">select</span> city<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> average <span class="token keyword">from</span> stu <span class="token keyword">group</span> <span class="token keyword">by</span> city<span class="token punctuation">;</span>
看哪些城市的平均分<span class="token operator">&gt;=</span><span class="token number">60</span>: <span class="token keyword">select</span> city<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> average <span class="token keyword">from</span> stu <span class="token keyword">group</span> <span class="token keyword">by</span> city <span class="token keyword">having</span> average<span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_9-7-分页-limit"><a href="#_9-7-分页-limit" class="header-anchor">#</a> 9.7 分页 limit:</h3> <p>select 字段 from 表 limit 索引, 个数;</p> <p>select * from stu limit 0, 3;  从第0个开始返回3条</p> <p>select * from stu limit 3, 3;  从第3个开始返回3条</p> <h4 id="_9-7-1-查询选项"><a href="#_9-7-1-查询选项" class="header-anchor">#</a> 9.7.1  查询选项</h4> <p>select [查询选项] 字段名称 from 表名;</p> <p>all:  显示所有查询出来的数据 [默认]</p> <p>distinct: 去除结果集中重复的数据之后再显示</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> name <span class="token keyword">from</span> stu<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">all</span> name <span class="token keyword">from</span> stu<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> name <span class="token keyword">from</span> stu<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>注意点:</p> <p>如果是通过distinct来对结果集中重复的数据进行去重</p> <p>那么只有结果集的所有列的数据都相同才会去重（结果集中的数据完全相同）</p> <p>select name, score from stu;</p> <p>select distinct name, score from stu;</p> <p><strong>完整的查询语句</strong></p> <p>select [查询选项] 字段名称 [from 表名] [where 条件] [order by 排序] [group by 分组] [having 条件] [limit 分页];</p> <p><strong>select all name,age from table where age&gt;18 order by  age group by city having city='北京' limit 0, 3;</strong></p> <h2 id="_10-多表查询"><a href="#_10-多表查询" class="header-anchor">#</a> 10.多表查询</h2> <p>- 多表查询只需要在单表查询基础上增加一张表即可</p> <p>select * from 表名1, 表名2;</p> <p>select * from stu, grade;</p> <p>注意点:</p> <p>- 默认情况下多表查询的结果是笛卡尔集，表1的记录数*表2的记录数</p> <h3 id="_10-1-union作用"><a href="#_10-1-union作用" class="header-anchor">#</a> 10.1 union作用</h3> <p>在纵向上将多张表的结果结合起来返回给我们</p> <p>select * from 表名1 union select * from 表名2;</p> <p>select id, name from stu union select id, score from grade;</p> <p>注意点:</p> <p>- 使用union进行多表查询, 返回的结果集的表头的名称是第一张表的名称</p> <p>- 使用union进行多表查询, 必须保证多张表查询的字段个数一致</p> <p>#select id, name from stu union select id, score, stuId from grade;</p> <p>#The used SELECT statements have a different number of columns</p> <p>- 使用union进行多表查询, 默认情况下会自动去重</p> <p>#select id, name from stu union select id, name from person;</p> <p>- 使用union进行多表查询, 如果不想自动去重, 那么可以在union后面加上all</p> <p>#select id, name from stu union all select id, name from person;</p> <h3 id="_10-2-表的连接查询"><a href="#_10-2-表的连接查询" class="header-anchor">#</a> 10.2 表的连接查询</h3> <p>- 将多张表中'关联的字段''连接'在一起查询我们称之为'表的连接查询'</p> <p>- 大白话: 查询多张表中满足条件的数据</p> <h4 id="_10-2-1-内连接-inner-join"><a href="#_10-2-1-内连接-inner-join" class="header-anchor">#</a> 10.2.1 内连接 inner join</h4> <p>原始方法查询：select * from stu, grade where stu.id = grade.stuId;</p> <p>使用内连接查询：select * from 表名1 inner join 表名2 on 条件：</p> <p>如：select * from stu inner join grade on stu.id = grade.stuId;</p> <p>注意点:</p> <p>- 在进行多表查询的时候, 如果想查询指定的字段, 那么必须在字段名称前面加上表名才行</p> <p>#select stu.id, stu.name, grade.score from stu inner join grade on stu.id = grade.stuId;</p> <p>- 在内连接中只会返回满足条件的数据</p> <h4 id="_10-2-2-外连接"><a href="#_10-2-2-外连接" class="header-anchor">#</a> 10.2.2 外连接</h4> <p>① 左外连接 left join ：左表不看条件</p> <p>- 在左外连接中, 左边的表是不看条件的, 无论条件是否满足, 都会返回左边表中所有的数据</p> <p>- 在左外连接中, 只有右边的表会看条件, 对于右边的表而言, 只有满足条件才会返回对应的数据</p> <p>#select stu.id, stu.name, grade.score from stu left join grade on stu.id = grade.stuId;</p> <p># 在以上的查询语句中stu表在左边, grade表在右边</p> <p># 所以stu表不看条件, 只有grade表看条件</p> <p>② 右外连接 right join：右表不看条件</p> <p>- 在右外连接中, 右边的表是不看条件的, 无论条件是否满足, 都会返回右边表中所有的数据</p> <p>- 在右外连接中, 只有左边的表会看条件, 对于左边的表而言, 只有满足条件才会返回对应的数据</p> <p>#select stu.id, stu.name, grade.score from stu right join grade on stu.id = grade.stuId;</p> <p># 在以上的查询语句中stu表在左边, grade表在右边</p> <p># 所以grade表不看条件, 只有stu表看条件</p> <h4 id="_10-2-3-交叉连接-cross-join"><a href="#_10-2-3-交叉连接-cross-join" class="header-anchor">#</a> 10.2.3 交叉连接   cross join</h4> <p>- 如果没有指定条件, 那么返回笛卡尔集</p> <p>#select stu.id, stu.name, grade.score from stu cross join grade;</p> <p>- 如果指定了条件, 那么就等价于内连接</p> <p>#select stu.id, stu.name, grade.score from stu cross join grade on stu.id = grade.stuId;</p> <h4 id="_10-2-4-全连接"><a href="#_10-2-4-全连接" class="header-anchor">#</a> 10.2.4 全连接</h4> <p>full join(MySQL不支持全连接)</p> <h4 id="_10-2-5-自然连接-natural"><a href="#_10-2-5-自然连接-natural" class="header-anchor">#</a> 10.2.5 自然连接(natural)</h4> <p>自然连接是用来简化'内连接和外连接'的</p> <p>如果多张表需要判断的条件字段名称一致, 那么不用编写条件, 自然连接会自动判断</p> <p>① 自然内连接</p> <p>传统内连接：select * from 表名1 inner join 表名2 on 条件;</p> <p>如：select * from stu inner join grade on stu.id = grade.stuId;</p> <p>自然内连接：select * from 表名1 natural join 表名2;</p> <p>如：select * from stu natural join grade;</p> <p>② 自然外连接</p> <p>自然左外连接 ：左表不看条件</p> <p>select * from stu natural left join grade;</p> <p>自然右外连接 ：右表不看条件</p> <p>select * from stu natural right join grade;</p> <p>注意点:</p> <p>- 如果没有指定条件, 也没有同名的字段, 那么就会返回笛卡尔集</p> <p>- 在自然连接中, 返回的结果集会自动优化, 会自动去除重复的判断字段（两个表中相同字段，只显示其中一个）</p> <h4 id="_10-2-6-using关键字"><a href="#_10-2-6-using关键字" class="header-anchor">#</a> 10.2.6 using关键字</h4> <p>如果多张表需要判断的条件字段名称一致, 那么除了可以使用自然连接来简化以外</p> <p>还可以使用using关键字来简化</p> <p>① 内连接</p> <p>原始：select * from stu inner join grade on stu.stuId = grade.stuId;</p> <p>using：select * from stu inner join grade using(stuId);</p> <p>② 外连接</p> <p>左外连接</p> <p>原始：select * from stu left join grade on stu.stuId = grade.stuId;</p> <p>using：select * from stu left join grade using(stuId);</p> <p>右外连接</p> <p>原始：select * from stu right join grade on stu.stuId = grade.stuId;</p> <p>using：select * from stu right join grade using(stuId);</p> <h3 id="_10-3-子查询"><a href="#_10-3-子查询" class="header-anchor">#</a> 10.3 子查询</h3> <p>- 将一个查询语句查询的结果作为另一个查询语句的条件来使用</p> <p>- 将一个查询语句查询的结果作为另一个查询语句的表来使用</p> <h4 id="_10-3-1-将一个查询语句查询的结果作为另一个查询的条件来使用"><a href="#_10-3-1-将一个查询语句查询的结果作为另一个查询的条件来使用" class="header-anchor">#</a> 10.3.1 将一个查询语句查询的结果作为另一个查询的条件来使用</h4> <p>① 标准子查询(返回的结果只有一个)</p> <p>原始：select stuId from grade where score = 100;	=&gt; stuId=3</p> <p>​			select name from stu where stuId = 3;</p> <p>子查询：select name from stu where stuId <strong>=</strong> (select stuId from grade where score = 100);</p> <p>② 非标准子查询(返回的结果有多个)</p> <p>原始：select stuId from grade where score &gt;= 60;	=&gt; stuId=1, stuId=3</p> <p>​			select name from stu where stuId = 3 OR stuId = 1;</p> <p>​			或：select name from stu where stuId in(3, 1);</p> <p>子查询：select name from stu where stuId <strong>in</strong>(select stuId from grade where score &gt;= 60);</p> <h4 id="_10-3-2-将一个查询语句查询的结果作为另一个查询的表来使用"><a href="#_10-3-2-将一个查询语句查询的结果作为另一个查询的表来使用" class="header-anchor">#</a> 10.3.2 将一个查询语句查询的结果作为另一个查询的表来使用</h4> <p>原始：select name, city, score from person where score &gt;= 60;</p> <p>子查询：select name, city, score from (select name, city, score from person where score &gt;= 60) as t;</p> <p>注意点:</p> <p>如果要将一个查询语句查询的结果作为另一个查询的表来使用, 那么必须给子查询起一个别名</p> <h2 id="_11-事务"><a href="#_11-事务" class="header-anchor">#</a> 11.事务</h2> <h3 id="_11-1-事务基本概念"><a href="#_11-1-事务基本概念" class="header-anchor">#</a> 11.1 事务基本概念</h3> <p>- MySQL中的事务主要用于处理容易出错的数据。</p> <p>- 事务可以用来维护数据库的完整性，保证成批的 SQL 语句要么全部执行，要么全部不执行。</p> <p>- 事务用来管理 insert,update,delete 语句</p> <p>- MySQL中只有使用了 Innodb 数据库引擎的表才支持事务。</p> <h3 id="_11-2-事务语法"><a href="#_11-2-事务语法" class="header-anchor">#</a> 11.2 事务语法</h3> <h4 id="_11-2-1-事务介绍"><a href="#_11-2-1-事务介绍" class="header-anchor">#</a> 11.2.1 事务介绍</h4> <p>开启事务: start transaction</p> <p>提交事务: commit</p> <p>回滚事务: rollback</p> <p>示例一:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> bank<span class="token punctuation">(</span>
  id  <span class="token keyword">int</span> <span class="token keyword">unsigned</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
  cardid <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  name   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  money <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> bank <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'1001'</span><span class="token punctuation">,</span> <span class="token string">'zs'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'1002'</span><span class="token punctuation">,</span> <span class="token string">'ls'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>​    id  int unsigned auto_increment primary key,</p> <p>​    cardid varchar(4),</p> <p>​    name   varchar(20),</p> <p>​    money int</p> <p>);</p> <p>insert into bank values (null, '1001', 'zs', 1000), (null, '1002', 'ls', 1000);</p> <p>第一种: 先扣再增加</p> <p>update bank set money=money-1000 where cardid='1002';</p> <p>update bank set money=money+1000 where cardid='1001';</p> <p>第二种: 先增加再扣</p> <p>update bank set money=money+1000 where cardid='1001';</p> <p>update bank set money=money-1000 where cardid='1002';</p> <p>start transaction; // 开启事务</p> <p>update bank set money=money-1000 where cardid='1002';</p> <p>rollback; // 任务失败, 回滚到开启之前状态</p> <p>update bank set money=money+1000 where cardid='1001';</p> <p>commit; // 任务成功, 提交开启事务之后所有操作</p> <p>注意点:</p> <p>事务的本质是开启事务的时候拷贝一张一模一样的表</p> <p>然后执行相关的操作都是在拷贝的这张表中做操作</p> <p>如果失败了, 如果执行了rollback, 那么系统就会自动删除拷贝的这张表</p> <p>所以失败了不会影响到原有的数据</p> <p>如果成功了, 如果执行了commit, 那么系统就会自动利用拷贝表中最新的数据覆盖原有表中的数据</p> <p>所以成功了会影响到原有的数据</p> <h4 id="_11-2-2-事务回滚点"><a href="#_11-2-2-事务回滚点" class="header-anchor">#</a> 11.2.2 事务回滚点</h4> <p>保存回滚点：savepoint 回滚点名称</p> <p>回到回滚点：rollback to 回滚点名称</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> bank <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'1003'</span><span class="token punctuation">,</span> <span class="token string">'333'</span><span class="token punctuation">,</span> <span class="token number">33333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">savepoint</span> abc<span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> bank <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'1003'</span><span class="token punctuation">,</span> <span class="token string">'444'</span><span class="token punctuation">,</span> <span class="token number">44444</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">savepoint</span> def<span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> bank <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token string">'1003'</span><span class="token punctuation">,</span> <span class="token string">'555'</span><span class="token punctuation">,</span> <span class="token number">55555</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">rollback</span> <span class="token keyword">to</span> abc<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_11-2-3-事务特点"><a href="#_11-2-3-事务特点" class="header-anchor">#</a> 11.2.3 事务特点:</h4> <p>- 原子性(关注的是状态)：</p> <p>事务开启后的所有操作，要么全部成功，要么全部失败，不可能出现部分成功的情况</p> <p>事务执行过程中如果出错，哪怕我们不手动回滚, 系统也会自动帮我们回滚</p> <p>- 一致性(关注数据可见性)：</p> <p>事务开始前和结束后，数据库的完整性约束没有被破坏</p> <p>例如 A向B转账，不可能A扣了钱，B却没收到</p> <p>- 持久性：</p> <p>事务完成后，事务对数据库的所有操作是永久的, 操作完成之后就不能再回滚</p> <p>- 隔离性：</p> <p>数据库允许多个并发事务同时对其数据进行读写和修改的能力，</p> <p>隔离性可以防止多个事务并发时由于交叉执行而导致数据的不一致。</p> <h4 id="_11-2-4-事务隔离级别"><a href="#_11-2-4-事务隔离级别" class="header-anchor">#</a> 11.2.4 事务隔离级别</h4> <p>读未提交（read uncommitted）: 一个事务可以读取另一个未提交事务的数据</p> <p>读提交（read committed）: 一个事务要等另一个事务提交后才能读取数据</p> <p>可重复读（repeatable read）: 一个事务范围内多个相同的查询返回相同的结果</p> <p>串行化（serializable）: 前面一个事务没有执行完后面一个事务不能执行</p> <p>-------------------------------------------------------------------------------------------------</p> <p>- 查看隔离级别:</p> <p>​    + 全局的: select @@global.transaction_isolation;</p> <p>​    + 当前会话的: select @@transaction_isolation;</p> <p>- 设置隔离级别:</p> <p>​    + 全局的: set global transaction isolation level 级别名称;</p> <p>​    + 当前会话: set session transaction isolation level 级别名称;</p> <p>-------------------------------------------------------------------------------------------------</p> <p><strong>- 脏读</strong></p> <p>能读取到其它事务没有提交的数据</p> <p>示例:</p> <p>A客户端:</p> <p>set session transaction isolation level read uncommitted;</p> <p>start transaction;</p> <p>update bank set money=money-1000 where cardId='1002';</p> <p>select * from bank;</p> <p>B客户端:</p> <p>set session transaction isolation level read uncommitted;</p> <p>select * from bank;</p> <p>- 解决办法(read committed)</p> <p>A客户端:</p> <p>set session transaction isolation level read committed;</p> <p>start transaction;</p> <p>update bank set money=money-1000 where cardId='1002';</p> <p>select * from bank;</p> <p>B客户端:</p> <p>set session transaction isolation level read committed;</p> <p>select * from bank;</p> <p>-------------------------------------------------------------------------------------------------</p> <p>- <strong>不可重复读</strong></p> <p>一个事务范围内多次查询的结果不同</p> <p>示例:</p> <p>A客户端:</p> <p>set session transaction isolation level read committed;</p> <p>start transaction;</p> <p>select * from bank;</p> <p>B客户端:</p> <p>set session transaction isolation level read committed;</p> <p>start transaction;</p> <p>update bank set money=money-1000 where cardId='1002';</p> <p>commit;</p> <p>A客户端:</p> <p>select * from bank;</p> <p>commit;</p> <p>- 解决办法(repeatable read)</p> <p>-------------------------------------------------------------------------------------------------</p> <p>- <strong>重复读</strong></p> <p>一个事务范围内多次查询的结果相同</p> <p>A客户端:</p> <p>set session transaction isolation level repeatable read;</p> <p>start transaction;</p> <p>select * from bank;</p> <p>B客户端:</p> <p>set session transaction isolation level repeatable read;</p> <p>start transaction;</p> <p>update bank set money=money-1000 where cardid='1002';</p> <p>commit;</p> <p>A客户端:</p> <p>select * from bank;</p> <p>commit;</p> <p>- 解决办法(serializable)</p> <p>-------------------------------------------------------------------------------------------------</p> <ul><li></li></ul> <p>- <strong>幻读</strong></p> <p>读到到的结果并不是最终的结果</p> <p>A客户端:</p> <p>set session transaction isolation level serializable;</p> <p>start transaction;</p> <p>select * from bank;</p> <p>B客户端:</p> <p>set session transaction isolation level serializable;</p> <p>start transaction;</p> <p>update bank set money=money-1000 where cardid='1002';</p> <p>commit;</p> <p>A客户端:</p> <p>select * from bank;</p> <p>commit;</p> <p>-------------------------------------------------------------------------------------------------</p> <p><strong>对应关系</strong></p> <p>事务隔离级别                  脏读   不可重复读  幻读</p> <p>读未提交（read-uncommitted）  是          是        是</p> <p>不可重复读（read-committed）   否          是        是</p> <p>可重复读（repeatable-read）       否          否        是</p> <p>串行化（serializable）           否          否        否</p> <h2 id="_12-视图"><a href="#_12-视图" class="header-anchor">#</a> 12.视图</h2> <h3 id="_12-1-视图基本概念"><a href="#_12-1-视图基本概念" class="header-anchor">#</a> 12.1 视图基本概念</h3> <p>- 视图本质就是将结果集缓存起来</p> <p>- 由于结果集是一张虚拟的表, 所以视图也是一张虚拟的表</p> <p>- 由于结果集是建立在表的基础上的, 所以视图也是建立在表的基础上的</p> <h3 id="_12-2-视图的作用"><a href="#_12-2-视图的作用" class="header-anchor">#</a> 12.2 视图的作用:</h3> <p>- 视图可以用来简化SQL语句</p> <p>- 视图可以用来隐藏表的结构</p> <p>- 视图可以用来提升数据安全性</p> <h3 id="_12-3-创建视图语法"><a href="#_12-3-创建视图语法" class="header-anchor">#</a> 12.3 创建视图语法</h3> <p>create view 视图名称 as select 语句;</p> <h3 id="_12-4-视图数据操作"><a href="#_12-4-视图数据操作" class="header-anchor">#</a> 12.4 视图数据操作</h3> <p>-- SELECT name, city FROM person;</p> <p>-- CREATE VIEW person_view as SELECT name, city FROM person;</p> <p>-- SELECT * FROM person_view;</p> <p>-- INSERT INTO person_view values ('it666', '武汉');</p> <p>-- UPDATE person_view set city='香港' WHERE name='it666';</p> <p>DELETE FROM person_view WHERE name='it666';</p> <p>注意点:</p> <p>由于视图保存的是结果集, 由于结果集是基于原始表的</p> <p>所以操作视图中的数据, 本质上操作的是原始表中的数据</p> <h4 id="_12-4-1-修改视图内容"><a href="#_12-4-1-修改视图内容" class="header-anchor">#</a> 12.4.1 修改视图内容</h4> <p>alter view 视图名称 as select 语句;</p> <p>alter view person_view as select name, score from person;</p> <h4 id="_12-4-2-删除视图"><a href="#_12-4-2-删除视图" class="header-anchor">#</a> 12.4.2 删除视图</h4> <p>drop view [if exists] 视图名;</p> <h4 id="_12-4-3-视图完整语句"><a href="#_12-4-3-视图完整语句" class="header-anchor">#</a> 12.4.3 视图完整语句</h4> <p>create [algorithm={merge||temptable||undefined}]</p> <p>view 视图名称</p> <p>as select 语句</p> <p>[with check option];</p> <h4 id="_12-4-4-视图算法"><a href="#_12-4-4-视图算法" class="header-anchor">#</a> 12.4.4 视图算法</h4> <p><strong>merge: 合并式(替代式)算法</strong></p> <p>- 将视图的语句和外层的语句合并之后再执行</p> <p>- 改算法允许更新数据</p> <p>-- SELECT name, city FROM person;</p> <p>-- CREATE algorithm=merge VIEW person_view1 AS SELECT name, city FROM person;</p> <p>-- SELECT * FROM person_view1;</p> <p>-- SELECT * FROM (SELECT name, city FROM person) as t;</p> <p><strong>temptable: 临时表(具代式)算法</strong></p> <p>- 将视图生成一个临时表, 再执行外层的语句</p> <p>- 该算法不允许更新数据</p> <p>-- CREATE algorithm=temptable VIEW person_view2 AS SELECT name, city FROM person;</p> <p>-- SELECT * FROM person_view2;</p> <p>-- (SELECT name, city FROM person) as t;</p> <p>-- SELECT * FROM t;</p> <p><strong>undefined: 未定义算法</strong></p> <p>由MySQL自己决定使用如上的哪一种算法, 默认就是undefined</p> <p>一般情况下会自动选择merge算法</p> <p>CREATE VIEW person_view3 AS SELECT name, city FROM person;</p> <p>CREATE ALGORITHM=UNDEFINED DEFINER=<code>root</code>@<code>localhost</code> SQL SECURITY DEFINER VIEW <code>person_view3</code> AS select <code>person</code>.<code>name</code> AS <code>name</code>,<code>person</code>.<code>city</code> AS <code>city</code> from <code>person</code></p> <h3 id="_12-5-视图限制-with-check-option"><a href="#_12-5-视图限制-with-check-option" class="header-anchor">#</a> 12.5 视图限制(with check option)</h3> <p>在with check option的选项下</p> <p>1.要保证数据update之后也要符合where的条件</p> <p>2.要保证insert之后的数据能被视图查询出来</p> <p>3.对于delete,有无 with check option都一样</p> <p>4.对于没有where字句的视图，使用with check option是多余的</p> <p>- 默认情况下哪怕插入的数据和更新的数据不符合创建视图条件, 我们也是可以通过视图来插入和更新的</p> <p>-- SELECT name, city, score FROM person WHERE score &gt;= 60;</p> <p>-- CREATE VIEW person_view AS SELECT name, city, score FROM person WHERE score &gt;= 60;</p> <p>-- INSERT INTO person_view values('it666', '台湾', 33);</p> <p>-- UPDATE person_view set score=55 WHERE name='ww';</p> <p>- 如果想让插入和更新的数据必须符合创建视图的条件, 那么就可以在创建视图的时候添加限制条件</p> <p>-- SELECT name, city, score FROM person WHERE score &gt;= 60;</p> <p>-- CREATE VIEW person_view AS SELECT name, city, score FROM person WHERE score &gt;= 60 with check option;</p> <p>-- INSERT INTO person_view values('it666', '台湾', 33); #报错, 由于不符合条件</p> <p>-- UPDATE person_view set score=55 WHERE name='ww';     #报错, 由于不符合条件</p> <h3 id="_12-7-视图更新限制"><a href="#_12-7-视图更新限制" class="header-anchor">#</a> 12.7 视图更新限制</h3> <p>① 如果视图的算法是merge算法, 那么可以更新视图</p> <p>② 如果没有指with check option, 那么无论数据符不符合创建视图条件都可以更新</p> <p>③ 如果指定了with check option, 那么只有符合创建视图条件才可以更新</p> <p>④ 除此之外由于视图是一张虚拟表, 视图是基于原始表的, 更新视图的本质就是更新原始表</p> <p>所以只有原始表中存在的原始数据才可以更新, 通过其它方式生成的数据都不可以更新</p> <p>-- SELECT city, avg(score) as avgScore FROM person GROUP BY city;</p> <p>-- CREATE VIEW person_view AS SELECT city, avg(score) as avgScore FROM person GROUP BY city;</p> <p>-- SELECT * FROM person_view;</p> <p>-- UPDATE person_view set avgScore=11 WHERE city='北京';</p> <p><strong>更新限制</strong></p> <p>聚合函数</p> <p>DISTINCT关键字</p> <p>GROUP BY子句</p> <p>HAVING子句</p> <p>UNION运算符</p> <p>FROM子句包含多张表</p> <p>SELECT语句中应用了不可更新的形势图</p> <p>##　13.预处理:</p> <p>所谓的预处理技术，最初也是由MySQL提出的一种减轻服务器压力的一种技术！</p> <p>- <strong>传统mysql处理流程</strong></p> <p>① 在客户端准备sql语句</p> <p>select * from stu where id=1;</p> <p>select * from stu where id=2;</p> <p>②  发送sql语句到MySQL服务器</p> <p>③  MySQL服务器对sql语句进行解析(词法,语法), 然后编译, 然后执行该sql语句</p> <p>④  服务器将执行结果返回给客户端</p> <p>弊端:</p> <p>- 哪怕多次传递的语句大部分内容都是相同的, 每次还是要重复传递</p> <p>- 哪怕语句是相同的, 每次执行之前还是要先解析、编译之后才能执行</p> <p></p> <p>- <strong>预处理的处理流程：</strong></p> <p>①  在客户端准备预处理sql语句</p> <p>prepare 预处理名称 from 'sql语句';</p> <p>prepare stmt from 'select * from stu where id=?;';</p> <p>②  发送预处理sql语句到MySQL服务器</p> <p>③  MySQL服务器对预处理sql语句进行解析(词法,语法), 但不会执行</p> <p>④  在客户端准备相关数据</p> <p>set @id=1;</p> <p>⑤ MySQL服务器对数据和预处理sql编译, 然后执行该sql语句</p> <p>execute stmt using @id;</p> <p>⑥  服务器将执行结果返回给客户端</p> <p>优点:</p> <p>- 只对sql语句进行了一次解析</p> <p>- 重复内容大大减少(网络传输更快)</p> <p><strong>预处理演示:</strong></p> <p>prepare stmt from 'select * from stu where id=?;';</p> <p>set @id=1;</p> <p>execute stmt using @id;</p> <p>set @id=2;</p> <p>execute stmt using @id;</p> <p><strong>如何在MySQL中定义变量</strong></p> <p>全局变量: @变量名称</p> <p>局部变量:</p> <p>给变量赋值: set @变量名称=值;</p> <h2 id="_14-存储过程"><a href="#_14-存储过程" class="header-anchor">#</a> 14.存储过程</h2> <h3 id="_14-1-什么是存储过程"><a href="#_14-1-什么是存储过程" class="header-anchor">#</a> 14.1 什么是存储过程?</h3> <p>存储过程和其它编程语言的函数很像, 可以用于封装一组特定功能的SQL语句集</p> <p>用户通过'call 存储过程的名称()' 来调用执行它。</p> <h3 id="_14-2-存储过程基本语法"><a href="#_14-2-存储过程基本语法" class="header-anchor">#</a> 14.2 存储过程基本语法</h3> <h4 id="_14-2-1-定义"><a href="#_14-2-1-定义" class="header-anchor">#</a> 14.2.1 定义</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> 存储过程名称<span class="token punctuation">(</span>形参列表<span class="token punctuation">)</span>

<span class="token keyword">begin</span>
  <span class="token comment">// sql语句</span>
  <span class="token comment">// ... ...</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>begin</p> <p>​    // sql语句</p> <p>​    // ... ...</p> <p>end;</p> <p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> show_stu<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
  <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> show_stu_by_id<span class="token punctuation">(</span>stuId <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
  <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> id<span class="token operator">=</span>stuId<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_14-2-2-调用"><a href="#_14-2-2-调用" class="header-anchor">#</a> 14.2.2 调用</h4> <p>call 存储过程名称(参数);</p> <h3 id="_14-3-查看存储过程"><a href="#_14-3-查看存储过程" class="header-anchor">#</a> 14.3 查看存储过程</h3> <h4 id="_14-3-1-查看mysql中所有存储过程"><a href="#_14-3-1-查看mysql中所有存储过程" class="header-anchor">#</a> 14.3.1 查看MySQL中所有存储过程</h4> <p>show procedure status;</p> <h4 id="_14-3-2-查看指定数据库中的存储过程"><a href="#_14-3-2-查看指定数据库中的存储过程" class="header-anchor">#</a> 14.3.2 查看指定数据库中的存储过程</h4> <p>show procedure status where db='db_name';</p> <h4 id="_14-3-3-查看指定存储过程的源代码"><a href="#_14-3-3-查看指定存储过程的源代码" class="header-anchor">#</a> 14.3.3 查看指定存储过程的源代码</h4> <p>show create procedure show_stu;</p> <h4 id="_14-3-4-删除存储过程"><a href="#_14-3-4-删除存储过程" class="header-anchor">#</a> 14.3.4 删除存储过程</h4> <p>drop procedure show_stu;</p> <h3 id="_14-4-如何在mysql中定义变量"><a href="#_14-4-如何在mysql中定义变量" class="header-anchor">#</a> 14.4 如何在MySQL中定义变量</h3> <p>- 全局变量:</p> <p>定义: @变量名称;</p> <p>赋值: set @全局变量名称=值;</p> <p>​      select 字段名称 into @全局变量名称 from 表名;</p> <p>- 局部变量:</p> <p>定义: declare 变量名称 数据类型;</p> <p>赋值: set 局部变量名称=值;</p> <p>​      select 字段名称 into 局部变量名称 from 表名;</p> <h4 id="_14-4-1-全局变量"><a href="#_14-4-1-全局变量" class="header-anchor">#</a> 14.4.1 全局变量</h4> <p>set @stuId = 2;</p> <p>set @stuName = '';</p> <p>select name into @stuName from stu where id=@stuId;</p> <p>select @stuName from dual;</p> <h4 id="_14-4-2-局部变量"><a href="#_14-4-2-局部变量" class="header-anchor">#</a> 14.4.2 局部变量</h4> <p>局部变量只能在存储过程和函数中定义, 所以也称之为存储过程变量</p> <p>create procedure show_stu3()</p> <p>begin</p> <p>​    declare stuId int default 1;</p> <p>​    declare stuName varchar(255);</p> <p>​    # set stuId = 2;</p> <p>​    select name into stuName from stu where id = stuId;</p> <p>​    select stuName from dual;</p> <p>end;</p> <h4 id="_14-5-存储过程参数"><a href="#_14-5-存储过程参数" class="header-anchor">#</a> 14.5 存储过程参数:</h4> <p>- MySQL存储过程中的参数分为:</p> <p>​    + in    输入参数[默认]</p> <p>​    + out   输出参数</p> <p>​    + inout 输入输出参数</p> <p><strong>示例一: 输入参数</strong></p> <p>外界传递给我们的参数</p> <div class="language-SQL line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> show_stu_by_id<span class="token punctuation">(</span><span class="token operator">in</span> stuId <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
   <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> id<span class="token operator">=</span>stuId<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>示例二: 输出参数</strong></p> <p>存储过程中返回给外界的参数</p> <p>MySQL存储过程中不能使用return返回值, 需要通过参数来向外返回值</p> <div class="language-SQL line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> show_stu_by_id<span class="token punctuation">(</span><span class="token operator">in</span> stuId <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
  <span class="token keyword">set</span> stuName <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">select</span> name <span class="token keyword">into</span> stuName <span class="token keyword">from</span> stu <span class="token keyword">where</span> id<span class="token operator">=</span>stuId<span class="token punctuation">;</span>
  <span class="token keyword">return</span> stuName<span class="token punctuation">;</span> <span class="token comment"># 报错</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> show_stu_by_id2<span class="token punctuation">(</span><span class="token operator">in</span> stuId <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">out</span> stuName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
  <span class="token keyword">select</span> name <span class="token keyword">into</span> stuName <span class="token keyword">from</span> stu <span class="token keyword">where</span> id<span class="token operator">=</span>stuId<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">set</span> <span class="token variable">@stuName</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> show_stu_by_id2<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">@stuName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@stuName</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>示例三: 输入输出参数</strong></p> <p>同时具备了输入参数和输出参数所有功能</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> show_stu_by_id3<span class="token punctuation">(</span><span class="token keyword">inout</span> <span class="token keyword">data</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
  <span class="token keyword">select</span> age <span class="token keyword">into</span> <span class="token keyword">data</span> <span class="token keyword">from</span> stu <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token keyword">data</span><span class="token punctuation">;</span>

<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">set</span> <span class="token variable">@data</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> show_stu_by_id3<span class="token punctuation">(</span><span class="token variable">@data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@data</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_15-自定义函数"><a href="#_15-自定义函数" class="header-anchor">#</a> 15.自定义函数</h2> <h3 id="_15-1-什么是自定义函数"><a href="#_15-1-什么是自定义函数" class="header-anchor">#</a> 15.1 什么是自定义函数</h3> <p>自定义函数和存储过程很像, 只不过自定义函数不需要手动通过call调用</p> <p>而是和其它的聚合函数一样会在SQL语句中自动被调用</p> <p>例如: select avg(score) from stu;</p> <p>例如: select count(*) from stu where age &gt;=18;</p> <h3 id="_15-2-创建自定义函数"><a href="#_15-2-创建自定义函数" class="header-anchor">#</a> 15.2 创建自定义函数</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> 函数名<span class="token punctuation">(</span>形参列表<span class="token punctuation">)</span> <span class="token keyword">returns</span> 数据类型 函数特征
<span class="token keyword">begin</span>
<span class="token keyword">sql</span>语句<span class="token punctuation">;</span>
<span class="token keyword">return</span> 值<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>函数特征</strong></p> <p>1 DETERMINISTIC 不确定的</p> <p>2 NO SQL 没有SQl语句，当然也不会修改数据</p> <p>3 READS SQL DATA 只是读取数据，不会修改数据</p> <p>4 MODIFIES SQL DATA 要修改数据</p> <p>5 CONTAINS SQL 包含了SQL语句</p> <h3 id="_15-3-调用函数"><a href="#_15-3-调用函数" class="header-anchor">#</a> 15.3 调用函数</h3> <p>select 函数名称(参数) from dual;</p> <p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> fn_add<span class="token punctuation">(</span>a <span class="token keyword">int</span><span class="token punctuation">,</span> b <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token keyword">int</span> <span class="token keyword">DETERMINISTIC</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> sum <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> sum <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> check_stu<span class="token punctuation">(</span>stuId <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DETERMINISTIC</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> stuName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> name <span class="token keyword">into</span> stuName <span class="token keyword">from</span> stu <span class="token keyword">where</span> id<span class="token operator">=</span>stuId<span class="token punctuation">;</span>
<span class="token keyword">return</span> stuName<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_15-4-查看函数"><a href="#_15-4-查看函数" class="header-anchor">#</a> 15.4 查看函数</h3> <h4 id="_15-4-1-查看所有函数"><a href="#_15-4-1-查看所有函数" class="header-anchor">#</a> 15.4.1 查看所有函数</h4> <p>show function status;</p> <h4 id="_15-4-2-查看指定数据库中的函数"><a href="#_15-4-2-查看指定数据库中的函数" class="header-anchor">#</a> 15.4.2 查看指定数据库中的函数</h4> <p>show function status where db='db_name';</p> <h4 id="_15-4-3-查看函数源代码"><a href="#_15-4-3-查看函数源代码" class="header-anchor">#</a> 15.4.3 查看函数源代码</h4> <p>show create function show_stu;</p> <h3 id="_15-5-删除存储过程"><a href="#_15-5-删除存储过程" class="header-anchor">#</a> 15.5 删除存储过程</h3> <p>drop function show_stu;</p> <h3 id="_15-6-语句"><a href="#_15-6-语句" class="header-anchor">#</a> 15.6 语句</h3> <h4 id="_15-6-1-if语句"><a href="#_15-6-1-if语句" class="header-anchor">#</a> 15.6.1 if语句</h4> <p>if 条件表达式 then</p> <p>... ...</p> <p>elseif 条件表达式 then</p> <p>... ...</p> <p>else</p> <p>... ...</p> <p>end if;</p> <p>示例一:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> fn_test<span class="token punctuation">(</span>age <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DETERMINISTIC</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> result <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> age <span class="token operator">&gt;=</span> <span class="token number">18</span> <span class="token keyword">then</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'成年人'</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'未成年人'</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>示例二:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> fn_test2<span class="token punctuation">(</span>score <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DETERMINISTIC</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> result <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> score <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> score <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token keyword">then</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'没有这个分数'</span><span class="token punctuation">;</span>
<span class="token keyword">elseif</span> score <span class="token operator">&lt;</span> <span class="token number">60</span> <span class="token keyword">then</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'不及格'</span><span class="token punctuation">;</span>
<span class="token keyword">elseif</span> score <span class="token operator">&lt;</span> <span class="token number">80</span> <span class="token keyword">then</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'良好'</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'优秀'</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_15-6-2-case语句"><a href="#_15-6-2-case语句" class="header-anchor">#</a> 15.6.2 CASE语句</h4> <p>case</p> <p>when 条件表达式 then</p> <p>... ...</p> <p>when 条件表达式 then</p> <p>... ...</p> <p>end case;</p> <p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> fn_test3<span class="token punctuation">(</span>score <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token keyword">returns</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DETERMINISTIC</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> result <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">case</span>
<span class="token keyword">when</span> score<span class="token operator">=</span><span class="token number">100</span> <span class="token keyword">then</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'还需努力'</span><span class="token punctuation">;</span>
<span class="token keyword">when</span> score<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">then</span>
<span class="token keyword">set</span> result <span class="token operator">=</span> <span class="token string">'不需要努力了'</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">case</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_15-6-3-循环语句"><a href="#_15-6-3-循环语句" class="header-anchor">#</a> 15.6.3 循环语句</h4> <p>while 条件表达式 do</p> <p>​    ... ...</p> <p>end while;</p> <p>示例: 1 + n的和 / 1 + 2 + 3 + 4 + 5</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> fun_test4<span class="token punctuation">(</span>num <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token keyword">returns</span> <span class="token keyword">int</span> <span class="token keyword">DETERMINISTIC</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> sum <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> currentIndex <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">1</span><span class="token punctuation">;</span>


<span class="token keyword">while</span> currentIndex <span class="token operator">&lt;=</span> num <span class="token keyword">do</span>
   <span class="token keyword">set</span> sum <span class="token operator">=</span> sum <span class="token operator">+</span> currentIndex<span class="token punctuation">;</span>
   <span class="token keyword">set</span> currentIndex <span class="token operator">=</span> currentIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>


<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

\<span class="token operator">-</span><span class="token comment">---</span>

<span class="token keyword">repeat</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

until 条件表达式 <span class="token keyword">end</span> <span class="token keyword">repeat</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>示例:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">function</span> fun_test6<span class="token punctuation">(</span>num <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token keyword">returns</span> <span class="token keyword">int</span> <span class="token keyword">DETERMINISTIC</span>

<span class="token keyword">begin</span>
<span class="token keyword">declare</span> sum <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> currentIndex <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">repeat</span>
  <span class="token keyword">set</span> sum <span class="token operator">=</span> sum <span class="token operator">+</span> currentIndex<span class="token punctuation">;</span>
  <span class="token keyword">set</span> currentIndex <span class="token operator">=</span> currentIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
until currentIndex <span class="token operator">&gt;</span> num <span class="token keyword">end</span> <span class="token keyword">repeat</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_16-索引"><a href="#_16-索引" class="header-anchor">#</a> 16.索引</h2> <p>需求: 往数据库里存储一万条数据</p> <p>实现方案:</p> <p>1.写一万条insert into语句</p> <p>2.将insert into语句封装到存储过程或者函数中</p> <p>将来怎么使用?</p> <p>是配合其它SQL语句使用, 还是单独使用</p> <p>单独使用--存储过程</p> <p>配合其它SQL语句使用--自定义函数</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> add_stus<span class="token punctuation">(</span>num <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> currentId <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> currentAge <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> currentName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> currentId <span class="token operator">&lt;</span> num <span class="token keyword">do</span>
<span class="token keyword">set</span> currentId <span class="token operator">=</span> currentId <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> currentAge <span class="token operator">=</span> floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> currentName <span class="token operator">=</span> concat<span class="token punctuation">(</span><span class="token string">'it'</span><span class="token punctuation">,</span> currentAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stu <span class="token keyword">values</span><span class="token punctuation">(</span>currentId<span class="token punctuation">,</span>currentName<span class="token punctuation">,</span>currentAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">call</span> add_stus<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#48.428s</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>注意点:</p> <p>以上封装存在的问题, 默认情况下每生成一条插入语句, 就会立即执行这条插入的语句</p> <p>所以整个过程我们生成了一万条插入语句, 我们解析了一万条插入的语句, 我们编译了一万条插入的语句, 我们执行了一万条插入的语句</p> <p>所以整个过程就比较耗时</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> add_stus2<span class="token punctuation">(</span>num <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
<span class="token keyword">declare</span> currentId <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> currentAge <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> currentName <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">''</span><span class="token punctuation">;</span>

<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> currentId <span class="token operator">&lt;</span> num <span class="token keyword">do</span>
<span class="token keyword">set</span> currentId <span class="token operator">=</span> currentId <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> currentAge <span class="token operator">=</span> floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> currentName <span class="token operator">=</span> concat<span class="token punctuation">(</span><span class="token string">'it'</span><span class="token punctuation">,</span> currentAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stu <span class="token keyword">values</span><span class="token punctuation">(</span>currentId<span class="token punctuation">,</span>currentName<span class="token punctuation">,</span>currentAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">call</span> add_stus2<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#1.713s</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>注意点:</p> <p>只要在循环前面加上set autocommit = 0;, 在循环后面加上commit;</p> <p>那么就不会生成一条插入语句就执行一条插入语句了</p> <p>会等到所有的插入语句都生成之后, 再统一的解析, 统一的编译, 统一的执行</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> add_stus3<span class="token punctuation">(</span>num <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
<span class="token keyword">set</span> <span class="token variable">@currentId</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentAge</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentName</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">prepare</span> stmt <span class="token keyword">from</span> <span class="token string">'insert into stu values(?,?,?);'</span><span class="token punctuation">;</span>

<span class="token keyword">while</span> <span class="token variable">@currentId</span> <span class="token operator">&lt;</span> num <span class="token keyword">do</span>
<span class="token keyword">set</span> <span class="token variable">@currentId</span> <span class="token operator">=</span> <span class="token variable">@currentId</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentAge</span> <span class="token operator">=</span> floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentName</span> <span class="token operator">=</span> concat<span class="token punctuation">(</span><span class="token string">'it'</span><span class="token punctuation">,</span> <span class="token variable">@currentAge</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">execute</span> stmt <span class="token keyword">using</span> <span class="token variable">@currentId</span><span class="token punctuation">,</span> <span class="token variable">@currentName</span><span class="token punctuation">,</span> <span class="token variable">@currentAge</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
<span class="token keyword">call</span> add_stus3<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#2.048s</span>

<span class="token keyword">create</span> <span class="token keyword">procedure</span> add_stus4<span class="token punctuation">(</span>num <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
<span class="token keyword">set</span> <span class="token variable">@currentId</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentAge</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentName</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">prepare</span> stmt <span class="token keyword">from</span> <span class="token string">'insert into stu values(?,?,?);'</span><span class="token punctuation">;</span>


<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
wile <span class="token variable">@currentId</span> <span class="token operator">&lt;</span> num <span class="token keyword">do</span>
<span class="token keyword">set</span> <span class="token variable">@currentId</span> <span class="token operator">=</span> <span class="token variable">@currentId</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentAge</span> <span class="token operator">=</span> floor<span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> <span class="token variable">@currentName</span> <span class="token operator">=</span> concat<span class="token punctuation">(</span><span class="token string">'it'</span><span class="token punctuation">,</span> <span class="token variable">@currentAge</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">execute</span> stmt <span class="token keyword">using</span> <span class="token variable">@currentId</span><span class="token punctuation">,</span> <span class="token variable">@currentName</span><span class="token punctuation">,</span> <span class="token variable">@currentAge</span><span class="token punctuation">;</span>
<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h3 id="_16-1-什么是索引"><a href="#_16-1-什么是索引" class="header-anchor">#</a> 16.1 什么是索引?</h3> <p>- 索引就相当于字典中的目录(拼音/偏旁部首手)</p> <p>有了目录我们就能通过目录快速的找到想要的结果.</p> <p>- 但是如果没有目录(拼音/偏旁部首手), 没有索引</p> <p>那么如果想要查找某条数据就必须从前往后一条一条的查找</p> <p>- 所以索引就是用于帮助我们提升数据的查询速度的</p> <h3 id="_16-2-索引的优缺点和使用原则"><a href="#_16-2-索引的优缺点和使用原则" class="header-anchor">#</a> 16.2 索引的优缺点和使用原则</h3> <h4 id="_16-2-1-优点"><a href="#_16-2-1-优点" class="header-anchor">#</a> 16.2.1 优点</h4> <p>​    + 大大加快数据的查询速度</p> <p>​    + 没有任何限制, 所有MySql字段都可以用作索引</p> <h4 id="_16-2-2-缺点"><a href="#_16-2-2-缺点" class="header-anchor">#</a> 16.2.2 缺点</h4> <p>​    + 索引是真实存在的会占空间, 会增加数据库体积</p> <p>​    + 如果对作为索引的字段进行增删修操作, 系统需要花费时间去更新维护索引</p> <h4 id="_16-2-3-原则"><a href="#_16-2-3-原则" class="header-anchor">#</a> 16.2.3 原则</h4> <p>​    + 对经常用于查询的字段应该创建索引(作为where条件字段、作为group by分组的字段, 作为order by排序的字段)</p> <p>​    + 对于主键和外键系统会自动创建索引, 无序我们手动创建</p> <p>​    + 对于数据量小的表不需要刻意使用索引</p> <h4 id="_16-3-索引分类"><a href="#_16-3-索引分类" class="header-anchor">#</a> 16.3 索引分类</h4> <p>​    + 单值索引: 将某个字段的值作为索引</p> <p>​    + 复合索引: 将多个字段的值作为索引</p> <p>​    + 唯一索引(唯一键): 索引列中的值必须是唯一的，但是允许为空值</p> <p>​    + 主键索引:是一种特殊的唯一索引，不允许有空值</p> <p>​    + ... ...</p> <h4 id="_16-4-查看当前查询是否使用索引"><a href="#_16-4-查看当前查询是否使用索引" class="header-anchor">#</a> 16.4 查看当前查询是否使用索引</h4> <h4 id="_16-4-1-查询没有索引的表"><a href="#_16-4-1-查询没有索引的表" class="header-anchor">#</a> 16.4.1 查询没有索引的表</h4> <p>SELECT * FROM stu WHERE id=999999; #0.695s</p> <h4 id="_16-4-2-查询有索引的表"><a href="#_16-4-2-查询有索引的表" class="header-anchor">#</a> 16.4.2 查询有索引的表</h4> <p>SELECT * FROM stu2 WHERE id=999999; #0.008s</p> <h4 id="_16-4-3-如何查看当前的查询语句有没有用到索引"><a href="#_16-4-3-如何查看当前的查询语句有没有用到索引" class="header-anchor">#</a> 16.4.3 如何查看当前的查询语句有没有用到索引</h4> <p>EXPLAIN 查询语句;</p> <p>如果返回的结果集中的key有值, 那么就表示当前的查询语句中用到了索引</p> <p>如果返回的结果集中的key没有值, 那么就表示当前的查询语句中没有用到索引</p> <h3 id="_16-5-如何添加索引"><a href="#_16-5-如何添加索引" class="header-anchor">#</a> 16.5 如何添加索引</h3> <p>①  给表设置主键, 只要设置了主键, 那么系统就会自动创建对应的索引</p> <p>②  给表设置外键, 只要设置了外键, 那么系统就会自动创建对应的索引</p> <p>③  给表设置唯一键, 只要设置了某一个字段的取值是唯一的, 也会自动创建对应的索引</p> <h4 id="_16-5-1-创建表的时候指定给哪个字段添加索引"><a href="#_16-5-1-创建表的时候指定给哪个字段添加索引" class="header-anchor">#</a> 16.5.1 创建表的时候指定给哪个字段添加索引</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> test1<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">index</span> idx_name<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token comment">#创建索引</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_16-5-2-创建好表之后再给指定字段添加索引"><a href="#_16-5-2-创建好表之后再给指定字段添加索引" class="header-anchor">#</a> 16.5.2 创建好表之后再给指定字段添加索引</h4> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> test2<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">index</span> idx_name <span class="token keyword">on</span> test2<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">#创建索引</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> test3<span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> test3 <span class="token keyword">add</span> <span class="token keyword">index</span> idx_name<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>​    id int,</p> <p>​    name varchar(20),</p> <p>);</p> <p>create index idx_name on test2(id); #创建索引</p> <p>create table test3(</p> <p>​    id int,</p> <p>​    name varchar(20),</p> <p>);</p> <p>alter table test3 add index idx_name(id);</p> <h4 id="_16-5-3-删除索引"><a href="#_16-5-3-删除索引" class="header-anchor">#</a> 16.5.3 删除索引</h4> <p>drop index 索引名称 on 表名;</p> <h3 id="_16-6-什么是索引算法"><a href="#_16-6-什么是索引算法" class="header-anchor">#</a> 16.6 什么是索引算法?</h3> <p>索引算法决定了如何创建索引</p> <p>索引算法决定了如何查找索引对应的数据</p> <p><strong>BTree索引:</strong></p> <p>BTree索引是基于平衡多叉排序树实现的, 能够缩短查找的次数</p> <p><strong>Hahs索引:</strong></p> <p>哈希索引是基于哈希表实现的, 只能用于memory存储引擎, 可以一次性定位到指定数据</p> <p>https://dev.mysql.com/doc/refman/8.0/en/index-btree-hash.html</p> <h2 id="_17-sequelize"><a href="#_17-sequelize" class="header-anchor">#</a> 17.sequelize</h2> <h3 id="_17-1-什么是sequelize"><a href="#_17-1-什么是sequelize" class="header-anchor">#</a> 17.1 什么是Sequelize?</h3> <p>Sequelize是一个基于Promise的NodeJS ORM模块</p> <h3 id="_17-2-什么是orm"><a href="#_17-2-什么是orm" class="header-anchor">#</a> 17.2 什么是ORM?</h3> <p>ORM(Object-Relational-Mapping)是对象关系映射</p> <p>对象关系映射可以把JS中的类和对象, 和数据库中的表和数据进行关系映射</p> <p>映射之后我们就可以直接通过类和对象来操作数据表和数据了, 就不用编写SQL语句了</p> <p>ORM有效的解决了直接在NodeJS中编写SQL不够直观, 不够高效, 容易出错等问题</p> <h3 id="_17-3-如何映射"><a href="#_17-3-如何映射" class="header-anchor">#</a> 17.3 如何映射?</h3> <p>在Sequelize中JS中的一个类(一个模型)就对应数据库中的一张表</p> <p>在Sequelize中JS中的一个对象就对应表中的一条数据(一条记录)</p> <p>在Sequelize中JS中的一个对象的属性就对应一条数据的一个字段</p> <p>① 创建一张表</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>cosnt 模型名称 <span class="token operator">=</span> Sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'表名'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> int<span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> int
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>② 创建一条记录</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>let zs <span class="token operator">=</span> 模型名称<span class="token punctuation">.</span>build<span class="token punctuation">(</span>{
  id: <span class="token number">1</span><span class="token punctuation">,</span>
  name: zs<span class="token punctuation">,</span>
  age: <span class="token number">18</span>
}<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>③ 操作表和数据</p> <p>只要是通过Sequelize定义的模型(类), 那么Sequelize就会自动给这个模型添加很多操作表和数据的方法</p> <p>以后我们就可以直接通过模型操作表, 通过模型创建出来的对象操作数据</p></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/Ajax.html"><div>
            jQuery中的Ajax
            <!----></div></a> <span class="date"></span></dt></dl><dl><dd>02</dd> <dt><a href="/express.html"><div>
            Express
            <!----></div></a> <span class="date"></span></dt></dl><dl><dd>03</dd> <dt><a href="/about.html"><div>
            
            <!----></div></a> <span class="date"></span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1421925110@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://music.163.com/#/song?id=544247584" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>Urnot</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.50cd9723.js" defer></script><script src="/assets/js/2.9b737b66.js" defer></script><script src="/assets/js/9.57a4b005.js" defer></script>
  </body>
</html>
